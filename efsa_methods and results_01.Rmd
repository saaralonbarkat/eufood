---
title: "The persuasion of symbolic elements in government public communications, and their moderation by personal relevance"
author: '**Saar Alon-Barkat**, **Madalina Busuioc**'
date: " "
output:
  html_document:
    theme: flatly
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
      toc_depth: 3
  pdf_document:
    toc: yes
  word_document: default
link-citations: yes
#bibliography: phd_paper_2.bib
csl: apa.csl
urlcolor: blue
---

<br>

Draft, last edited at `r Sys.Date()`.


```{r silent-packages, echo = FALSE, eval = TRUE, message=FALSE, include = FALSE}
library(sjPlot)
library(tidyverse)
library(car)
library(reshape2)
library(viridis)
library(ggthemes)
library(corrr)
library(kableExtra)
library(dotwhisker)
library(sjmisc)
library(interflex)
library(effsize)
library(broom)
library(sjstats)
library(stargazer)
library(AER)
library(ggpubr)
```



```{r , include=FALSE, echo=FALSE,warning=FALSE,message=FALSE}
#data

source("C:/SAAR/UNIVERSITY/R/EFSA/code/efsa_dm_01.R")


#Adding other vars

##labels for conditions
efsa_00 <- efsa_00 %>% 
  mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'"),
         ban.pesticide.lab = ban.pesticide %>% Recode("0='Approve pesticide';1='Ban pesticide'"))

##org. types
efsa_00 <- efsa_00 %>% 
  mutate(organization.type.short = organization.type.raw %>% 
           Recode("'non-governmental nonprofit organization'='2-ngo';
                  c('trade association','company')='1-industry';
                  else='0-other'"))

##prior food beliefs index
efsa_00 <- efsa_00 %>% 
  mutate(prior.beliefs.food = (-1*greediness.food.industry+
                                supports.gmo+
                                supports.pesticides+
                                supports.additives)/4)

##credibility aspects


efsa_00 <- efsa_00 %>% 
    mutate(credibility.pest.index = (credibility.pest.q1+
           credibility.pest.q2+
           credibility.pest.q3+
           credibility.pest.q4+
           credibility.pest.q5+
           credibility.pest.q6)/6,
         credibility.pest.commitment = credibility.pest.q6,
         credibility.pest.considerations = (credibility.pest.q1+
           credibility.pest.q2+
           credibility.pest.q3)/3,
         credibility.pest.expertise = (credibility.pest.q4+
           credibility.pest.q5)/2) %>% 
  mutate(credibility.pest.index.01 = (credibility.pest.commitment+
                                     credibility.pest.considerations+
                                     credibility.pest.expertise)/3)
  


#filtering 

efsa_01 <- efsa_00 %>% 
  filter(comprehension.check==1)

efsa_02 <- efsa_00 %>% 
  filter(comprehension.check==1,
         familiarity.pesticide==0)


#subsets for pest. cases

efsa_00_ban.pest <- efsa_00 %>% 
  filter(ban.pesticide==1)

efsa_00_approve.pest <- efsa_00 %>% 
  filter(ban.pesticide==0)

#subsets for treatment

efsa_00_treatment <- efsa_00 %>% 
  filter(treatment==1)

efsa_00_control <- efsa_00 %>% 
  filter(treatment==0)


efsa_00.t1 <- efsa_00 %>% 
  drop_na(independence.polit.efsa) %>% 
  data.frame() %>% 
  mutate(approve.pesticide = ban.pesticide %>% Recode("0=1;1=0"))


```



<br>

# Hypotheses

<br>

I theorize that:

*H<sub>1</sub> - The more (less) stakeholders perceive a regulatory agency as independent from political stakeholders, the more (less) they are likely to perceive its regulatory decisions as credible.*

*H<sub>2</sub> - The more (less) congruent is a regulatory decision with stakeholders' prior positions, the more (less) they are likely to perceive it as credible.*


<br>

# Research design
We empirically examine these hypotheses in relation the European Food Safety Authority (EFSA). We conducted an experiment, embedded in a survey among external stakeholders of EFSA, as detailed below. The employment of an experimental design enables us to rigorously examine the causal effects of perceived independence and prior standpoints on regulatory credibility. At the same time, by surveying real stakeholders about actual regulatory decisions of the agency, we substantiate the study's generalizability to real world setting. 

While experiments have been widely used by Public Administration scholars in recent years to explore the perceptions of citizens and political representatives about public agencies (e.g. ###), to the best of our knowledge, this is the first study to experimentally examine the factors that shape the perceptions of stakeholders and interest groups members regarding agencies' decisions. In addition, this is the first study to manipulate agencies perceived independence from political stakeholders.

In the following section we describe the population of survey respondents and their selection and recruitment, the course of the survey and experimental procedures and the operationalization of our main variables.   

<br>

## *Data collection*

```{r, echo=FALSE, warning=FALSE, message=F}
n.invitations = 675
n.errors = 45
n.invitations_effective = n.invitations-n.errors

n.start = efsa_00 %>% nrow()
n.reach_credibility.pest = efsa_00 %>% drop_na(credibility.pest.index) %>% nrow()
n.reach_independence = efsa_00 %>% drop_na(independence.polit.efsa) %>% nrow()
n.reach_end = efsa_raw %>% filter(Q13.13 !=0)%>% nrow()
```

We constructed a list of names, organizational affiliation and contact details of potential stakeholders of EFSA, based on three data sources. First, we relied on the *EU Transparency Register* (http://ec.europa.eu/transparencyregister), which includes information on more than 10,000 organisations representing particular interests at EU level (Joint Transparency Register Secretariat, 2019). The register's information is updated annually by the organizations themselves, and includes details of their "person with legal responsibility" and "person in charge of EU relations". To restrict the list to potential stakeholders of EFSA, we filtered the dataset based on organizations' self-reporting of their goals, activities and fields on interest. This search yielded a list of 3,155 persons from 2,045 different organizations related to the domains of food and agriculture. It included representatives of the industry, NGOs and advocacy groups, professional organizations engaging in research, low firms and consultancy groups. We then supplemented the latter with two additional sources, obtained from EFSA's website: official documents of EFSA's meetings with stakeholders and the lists of the agency's "registered stakeholders". The two latter sources included 392 persons from 259 organizations. Further details about the construction the two lists are available in the supplementary appendix [TBA].         

Thereafter, we searched the internet for email addresses of these stakeholders. For the first list, retrieved from the transparency register, we conducted an automatic search. We web-scraped their organizations' official websites, and matched the found email patterns with participants' names and initials.[^footnote_email.scraping] Using this method, which enabled us to avoid time-consuming manual search, we managed to find email addresses of 437 stakeholders (`r ((437/3155)*100) %>% round(0)`% of total names in the list). For the second list, which includes stakeholders that participated in EFSA meetings and consultations, we conducted both automatic and manual online search, through which we managed to find addresses of 229 persons (`r ((229/392)*100) %>% round(0)`%). 

[^footnote_email.scraping]: Our r code is available at: https://github.com/saaralonbarkat/stakeholders.emails. 

The survey was conducted online through Qualtrics Survey Software, as explained below. Between February-May 2019, we sent these persons email invitations with anonymous links to the survey, followed by three reminders. We sent the messages from our university email address, and invited the stakeholders to fill in the anonymous survey. We also asked them to invite other executives and staff members in their organizations to fill the survey. Importantly, to avoid priming, we did not tell them about the study's focus on EFSA and food regulation. Rather, we generally presented it as an expert survey on regulatory policy at the EU, as a part of our academic study. 

In total, `r n.start` people started filling the survey, and `r n.reach_independence` completed the outcome variable items, which represent a sizable response rate of roughly `r (n.reach_independence/n.invitations_effective*100)%>% round(-1)`%.[^footnote_response.rate] More than half of the respondents (`r ((efsa_00 %>% filter(age>=50) %>% nrow())/(efsa_00 %>% drop_na(age) %>% nrow())*100) %>% round(0)`%) are older than 50 years, `r ((efsa_00 %>% filter(female==0) %>% nrow())/(efsa_00 %>% drop_na(female) %>% nrow())*100) %>% round(0)`% of them are men and `r ((efsa_00 %>% filter(education %in% c("3 Master","4 Doctorat")) %>% nrow())/(efsa_00 %>% drop_na(education) %>% nrow())*100) %>% round(0)`% of them have a Master or Doctorate degree. At the beginning of the survey, we asked participants in which type of organization do they work. `r ((efsa_00 %>% filter(organization.type.short=="1-industry") %>% nrow())/(efsa_00 %>% drop_na(organization.type.short) %>% nrow())*100) %>% round(0)`% of respondents reported working in a company or a trade association, `r ((efsa_00 %>% filter(organization.type.short=="2-ngo") %>% nrow())/(efsa_00 %>% drop_na(organization.type.short) %>% nrow())*100) %>% round(0)`% in an NGO, and the remaining `r ((efsa_00 %>% filter(organization.type.short=="0-other") %>% nrow())/(efsa_00 %>% drop_na(organization.type.short) %>% nrow())*100) %>% round(0)`% elsewhere (henceforth referred as "others"). To assess the relevance of EFSA to these respondents, we asked them towards the end of the survey a series of questions regarding their relations to the agency. `r ((efsa_00 %>% filter(informed.efsa>0) %>% nrow())/(efsa_00 %>% drop_na(informed.efsa) %>% nrow())*100) %>% round(0)`% of them indicated that they are well informed about the agency's mandate (more than 0 on a -5 to +5 Likert scale), `r ((efsa_00 %>% filter(affect.decisions.efsa>0) %>% nrow())/(efsa_00 %>% drop_na(affect.decisions.efsa) %>% nrow())*100) %>% round(0)`% reported that the agency’s decisions may affect the operations of their organization and `r ((efsa_00 %>% filter(str_detect(interact.efsa,c("2.|3.|4.|5."))==T) %>% nrow())/(efsa_00 %>% drop_na(interact.efsa) %>% nrow())*100) %>% round(0)`% reported that their organization interacts with EFSA at least once a year. Overall, our respondents represent a relatively diverse sample of external stakeholders of EFSA. `r table.x=0``r table.x=table.x+1`**Table `r table.x`** presents main characteristics of our sample of respondents. 

[## TBA table `r table.x` ##]

[## TBA - analysis of selection bias, based on comparison between percentage of industry and NGOs in our lists and in the final sample ##].      

[^footnote_response.rate]: To estimate response rate, we divided the number of observations by the number of invitations while subtracting the email addresses that returned automatic error messages (*n*=45). However, since some of the respondents received the invitation from other participants rather than directly by us, the exact response rate may be somewhat lower.   

<br>

## *Procedure*
As noted above, the questionnaire was presented to the participants as an expert survey as a part of an academic study on regulatory policy at the EU. After obtaining respondents' consent, we asked them to specificy the type of organization in which they work, as well as the policy areas that are most relevant to the operations of their organization. Thereafter, we asked them regarding their attitudes about the European commission, Parliament and the Council of the European Union. We also asked about the credibility of EFSA, as well as of other three EU regulatory agencies. Thereafter, we asked them a set of questions aimed at assessing their prior beliefs about regulation of food safety, and specifically pesticides. To disguise our focus on food policy, we embedded these questions within batteries of questions regarding various policy domains. To further avoid a priming effect, we then added questions regarding their opinions about the use of Machine Learning algorithms in decision making.

We then told participants that we will present them with a case of a regulatory risk assessment on food safety policy, and ask their opinion about it. The case included three pages. The first page, which was identical for all responednts, included a general background about the regulation of risks in pesticides pesticides in the EU. The second page included a background about EFSA. Participants were assigned to treatment and control conditions. The text of the treatment condition emphasized the independence of EFSA from the political stakeholders in the EU. The text of the control condition was designed to be neutral, and regarded the role of EFSA in communicating its opinions. The third page included a description of a decision about a specific pesticide. Participants were allocated to one of two cases. The first case regarded the pesticide "Flupyradifurone", which was approved by the commission, based on EFSA's risk assassement (##EFSA 2015##). Respondents were explained that EFSA could not identify a high risk of the use of the pesticide, although it did noted completely rule out its risks for human health. The second case regarded the pesticide "Amitrole", which was banned by the commission, based on EFSA's risk assassement (##EFSA 2015##). Respondents were explained that EFSA did identify critical concern regarding the use of the pesticide. We henceforth regard the two cases in short as "approve" and "ban" decisions. All the different conditions had roughly of the same length. The full texts cases, and the different conditions, is presented in `r figure.x=0``r figure.x=figure.x+1`**Figure `r figure.x`**.

![](C:/SAAR/UNIVERSITY/R/EFSA/papers/myfigures/manipulations.png) 


U political institutions, and about their general perceptions regarding the risks involved in the food industry. Thereafter, they will be presented with one of two cases of real formal decisions of EFSA concerning the safety of food products. Participants will be randomly allocated to control and treatment groups. Participants in the treatment will receive information about EFSA’s independence from political stakeholders, whereas participants in the control group will receive general information about the agency and its structure. After presenting these factual cases of decisions, participants will be asked about the their credibility, as well as on their attitudes about EFSA.      

<br>

##*Variables*


```{r, echo=FALSE, warning=FALSE, message=F}

```


<br>
    

# Results


# Independence vs. priors

<br>

```{r, fig.width=8,echo=FALSE,warning=FALSE,message=FALSE}
efsa_00.t1 %>% 
  select(credibility.pest.considerations,credibility.pest.expertise,credibility.pest.commitment,
         independence.polit.efsa) %>% 
  gather("key","value",-independence.polit.efsa) %>% 
  mutate(key = Recode(key,"'credibility.pest.commitment'='c. Commitment';'credibility.pest.considerations'='a. Considerations';'credibility.pest.expertise'='b. Expertise'")) %>% 
  ggplot(aes(independence.polit.efsa,
             value))+
  geom_smooth(method="lm",colour="black")+
  geom_jitter(width = 0.1,height = 0.1,size=1,colour="dodgerblue2",alpha=0.4)+
  scale_x_continuous(name="Perceived independence of EFSA",breaks=-5:5)+
  scale_y_continuous(name = "Decision credibility",breaks=-5:5,limits = c(-5.5,5))+
  facet_wrap(~key)+
  theme_tufte()+
  stat_cor(method = "pearson", label.x = 3, label.y = 30)+
  labs(title = "Fig. X: Bivariate correlation between independence and credibility",
              subtitle = "",
              caption = "")+
  theme(
  plot.caption = element_text(hjust = 0)
  )
```

<br>
```{r, results="asis",echo=FALSE,warning=FALSE,message=FALSE}



tmod1.0.0 <- lm(credibility.pest.considerations~ 
            ban.pesticide,
            data=efsa_00.t1)

tmod1.0.1 <- update(tmod1.0.0, . ~ . + independence.polit.efsa)


tmod1.0.2 <- update(tmod1.0.1, . ~ . + supports.pesticides +
                                       organization.type.short)

tmod1.0.3 <- lm(credibility.pest.considerations~ 
            independence.polit.efsa + 
              ban.pesticide*(supports.pesticides +
                             organization.type.short),
              data=efsa_00.t1) 



tmod2.0.0 <- update(tmod1.0.0, credibility.pest.expertise ~ . )
tmod2.0.1 <- update(tmod1.0.1, credibility.pest.expertise ~ . )
tmod2.0.2 <- update(tmod1.0.2, credibility.pest.expertise ~ . )
tmod2.0.3 <- update(tmod1.0.3, credibility.pest.expertise ~ . )

tmod3.0.0 <- update(tmod1.0.0, credibility.pest.commitment ~ . )
tmod3.0.1 <- update(tmod1.0.1, credibility.pest.commitment ~ . )
tmod3.0.2 <- update(tmod1.0.2, credibility.pest.commitment ~ . )
tmod3.0.3 <- update(tmod1.0.3, credibility.pest.commitment ~ . )

tmod1.0.0 <-tmod1.0.0  
tmod1.0.1 <- tmod1.0.1
tmod1.0.2 <- tmod1.0.2
tmod1.0.3 <- tmod1.0.3




stargazer(tmod1.0.0,tmod1.0.1,tmod1.0.2,tmod1.0.3,
          tmod2.0.0,tmod2.0.1,tmod2.0.2,tmod2.0.3,
          tmod3.0.0,tmod3.0.1,tmod3.0.2,tmod3.0.3,
          type="html",
          style = "apsr",
          omit.stat = c("rsq","ser", "f"),
          dep.var.labels=c("Considerations",
                           "Expertise",
                           "Commitment"),
          covariate.labels=c(
            "Ban pesticide (0=approve)",
            "Perceived independece",
            "Supports pesticides",
            "Supports pesticides x Ban pesticide",
            "Industry (ref=other)",
            "NGO (ref=other)",
            "Industry x Ban pesticide",
            "NGO x Ban pesticide"),
          order = c(1,2,3,6,4,5,6,7,8),
          initial.zero = FALSE,
          notes = "*Notes*: Table entries are non-standardized OLS-regression coefficients, with Standard errors in parentheses. The reference category for the organizations is 'other'",
          notes.append = FALSE,
          title = "Table X: Decision credibility. Regression table")

```
&ast;*p*<.1; &ast;&ast;*p*<.05; &ast;&ast;&ast;*p*<.01 (two-tailed).

<br>

## Conditional effect of organization type

<br>

```{r, fig.width=10,echo=FALSE,warning=FALSE,message=FALSE}
efsa_00 %>% 
  drop_na(credibility.pest.commitment) %>% 
  select(credibility.pest.considerations,credibility.pest.expertise,credibility.pest.commitment,
         ban.pesticide.lab,
         organization.type.short) %>% 
  gather("key","value",-ban.pesticide.lab,-organization.type.short) %>% 
  mutate(key = Recode(key,"'credibility.pest.commitment'='c. Commitment';'credibility.pest.considerations'='a. Considerations';'credibility.pest.expertise'='b. Expertise'")) %>% 

ggplot(aes(x=organization.type.short,y=value,
           shape=ban.pesticide.lab,
           color=organization.type.short))+
  scale_y_continuous(name="",breaks=-5:5)+
  xlab("")+
  geom_hline(yintercept = 0, colour = "grey60", linetype = 2)+
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", fun.args=list(conf.int=0.95), alpha=0.5,width=0.1,size=1,position=position_dodge(0.4)) + 
  stat_summary(fun.y = mean, geom = "point", size=3,position=position_dodge(0.4))+
  scale_shape_manual(name = "Case/decision", values=c(1,4),labels = c("Approve pesticide","Ban pesticide"))+
  scale_color_manual(guide=F, name = "Organization type", values=c("#2E9FDF","#E7B800","green4"))+
  facet_wrap(~key)+
  theme_tufte() +
  labs(title = "Fig. 6: Decision credibility across organization groups",
              subtitle = "",
              caption = "Note: Red dots and bars represent means and 95% CIs")+
  theme(
  plot.caption = element_text(hjust = 0)
  )

```

<br>

## Conditional effect of supports pesticide

<br>
```{r, fig.width=8,echo=FALSE,warning=FALSE,message=FALSE}


p1 <- inter.binning(Y = "credibility.pest.considerations", D = "ban.pesticide", X = "supports.pesticides", Z = c("independence.polit.efsa"), data = efsa_00.t1, nbins = 5,na.rm = TRUE, main = " ")$graph +
  geom_hline(yintercept = 0, colour = "grey60", linetype = 2)+
  scale_y_continuous(name = "Marginal effect of ban pesticide",limits = c(-5.2,5),breaks = -5:5)+
  theme_tufte()  +
  scale_x_continuous(name = "Support for pesticides",limits = c(-5,5),breaks = -5:5)+
  labs(title = " ",
              subtitle = "a. Considerations",
              caption = "")+
  theme(
  plot.caption = element_text(hjust = 0)
  )

p2 <- inter.binning(Y = "credibility.pest.expertise", D = "ban.pesticide", X = "supports.pesticides", Z = "independence.polit.efsa", data = efsa_00.t1, nbins = 5,na.rm = TRUE, main = " ")$graph +
  geom_hline(yintercept = 0, colour = "grey60", linetype = 2)+
  scale_y_continuous(name = "Marginal effect of ban pesticide",limits = c(-5.2,5),breaks = -5:5)+
  scale_x_continuous(name = "Support for pesticides",limits = c(-5,5),breaks = -5:5)+
  theme_tufte()  +
  labs(title = " ",
              subtitle = "b. Expertise",
              caption = "")+
  theme(
  plot.caption = element_text(hjust = 0)
  )

p3 <- inter.binning(Y = "credibility.pest.commitment", D = "ban.pesticide", X = "supports.pesticides", Z = "independence.polit.efsa", data = efsa_00.t1, nbins = 5,na.rm = TRUE, main = " ")$graph +
  geom_hline(yintercept = 0, colour = "grey60", linetype = 2)+
  scale_y_continuous(name = "Marginal effect of ban pesticide",limits = c(-5.2,5),breaks = -5:5)+
  scale_x_continuous(name = "Support for pesticides",limits = c(-5,5),breaks = -5:5)+
  theme_tufte()  +
  labs(title = " ",
              subtitle = "c. Commitment",
              caption = "")+
  theme(
  plot.caption = element_text(hjust = 0)
  )



ggarrange(p1,p2,p3,
          ncol = 3,nrow = 1) %>% 
  annotate_figure(fig.lab = "Figure X: Interaction between decision and support for pesticides")



```
<br>


# Experimental measure for independence 

<br>

```{r,echo=FALSE,warning=FALSE,message=FALSE}
t1 <- efsa_00 %>%
  drop_na(independence.polit.efsa) %>% 
  group_by(treatment) %>% 
  summarise(N = n(),
    mean_independence.polit.efsa = (mean(independence.polit.efsa,na.rm = T)) %>% round(2),
    se_independence.polit.efsa = (sd(independence.polit.efsa,na.rm = T)/sqrt(n())) %>% round(2),
    
    mean_credibility.pest.considerations = (mean(credibility.pest.considerations,na.rm = T)) %>% round(2),
    se_credibility.pest.considerations = (sd(credibility.pest.considerations,na.rm = T)/sqrt(n())) %>% round(2),
    
    mean_credibility.pest.expertise = (mean(credibility.pest.expertise,na.rm = T)) %>% round(2),
    se_credibility.pest.expertise = (sd(credibility.pest.expertise,na.rm = T)/sqrt(n())) %>% round(2),
    
    mean_credibility.pest.commitment = (mean(credibility.pest.commitment,na.rm = T)) %>% round(2),
    se_credibility.pest.commitment = (sd(credibility.pest.commitment,na.rm = T)/sqrt(n())) %>% round(2))


iv.table.t <- data.frame(
  x1 = c("First stage (FS)",
         "Reduced form (RF)",
          "IV estimate ((RF) / (FS))",
          rep(c("Reduced form",
          "IV estimate"),2),
          "N"),
  Variable = c("Perceived independence",
          "Credibility - considerations","",
          "Credibility - expertise","",
          "Credibility - commitment","","")
  ) %>% 

  mutate(treat.mean = c(filter(t1,treatment==1)$mean_independence.polit.efsa,
                        filter(t1,treatment==1)$mean_credibility.pest.considerations,
                        "",
                        filter(t1,treatment==1)$mean_credibility.pest.expertise,
                        "",
                        filter(t1,treatment==1)$mean_credibility.pest.commitment,
                        "",
                        "") %>% as.numeric(),
         treat.se = c(filter(t1,treatment==1)$se_independence.polit.efsa,
                        filter(t1,treatment==1)$se_credibility.pest.considerations,
                        "",
                        filter(t1,treatment==1)$se_credibility.pest.expertise,
                        "",
                        filter(t1,treatment==1)$se_credibility.pest.commitment,
                        "",
                        "")%>% as.numeric(),
         control.mean = c(filter(t1,treatment==0)$mean_independence.polit.efsa,
                        filter(t1,treatment==0)$mean_credibility.pest.considerations,
                        "",
                        filter(t1,treatment==0)$mean_credibility.pest.expertise,
                        "",
                        filter(t1,treatment==0)$mean_credibility.pest.commitment,
                        "",
                        "")%>% as.numeric(),
         control.se = c(filter(t1,treatment==0)$se_independence.polit.efsa,
                        filter(t1,treatment==0)$se_credibility.pest.considerations,
                        "",
                        filter(t1,treatment==0)$se_credibility.pest.expertise,
                        "",
                        filter(t1,treatment==0)$se_credibility.pest.commitment,
                        "",
                        "")%>% as.numeric()) %>% 
        
  mutate(
Control = 
           c(
             
str_c(
  control.mean,
  " (",
  control.se,
  ")"
  )),

Treatment = 
           c(
             
str_c(
  treat.mean,
  " (",
  treat.se,
  ")"
  )),

diff = treat.mean-control.mean)


t_independence.polit.efsa <- t.test(independence.polit.efsa~treatment,efsa_00 %>% drop_na(independence.polit.efsa))[["statistic"]][["t"]] %>% abs() %>% round(3)

t_credibility.pest.considerations <- t.test(credibility.pest.considerations~treatment,efsa_00 %>% drop_na(independence.polit.efsa))[["statistic"]][["t"]] %>% abs() %>% round(3)

t_credibility.pest.expertise <- t.test(credibility.pest.expertise~treatment,efsa_00 %>% drop_na(independence.polit.efsa))[["statistic"]][["t"]] %>% abs() %>% round(3)

t_credibility.pest.commitment <- t.test(credibility.pest.commitment~treatment,efsa_00 %>% drop_na(independence.polit.efsa))[["statistic"]][["t"]] %>% abs() %>% round(3)

t2 <- c(t_independence.polit.efsa,
        t_credibility.pest.considerations,NA,
        t_credibility.pest.expertise,NA,
        t_credibility.pest.commitment,NA,NA)

iv.table.t <- iv.table.t %>% 
mutate(t=t2,
       se.diff = (diff/t2) %>% round(2)) %>% 
  mutate(Difference = str_c(diff,
                            " (",
                            se.diff,
                            ")")) %>%  



#fs.diff =  iv.table.t$diff[1]

mutate(iv.estimate = (diff/iv.table.t$diff[1]) %>% round(2))

iv.table <- iv.table.t %>% 
select(x1,
       Variable,
       Treatment,
       Control,
       Difference,
       t)

iv.table$Difference[c(3,5,7)] = iv.table.t$iv.estimate[c(2,4,6)]


iv.table[is.na(iv.table)] <- ""

iv.table[8,3] = efsa_00 %>% drop_na(independence.polit.efsa) %>% filter(treatment==1) %>% nrow()
iv.table[8,4] = efsa_00 %>% drop_na(independence.polit.efsa) %>% filter(treatment==0) %>% nrow()
iv.table[8,5] = efsa_00 %>% drop_na(independence.polit.efsa) %>% nrow()


iv.table %>% 
  kable(caption = "Table X: Instrumental Variable Estimation",
        col.names = c("","","Treatment","Control","Difference","t")) %>%
  add_header_above(c(" " = 2, "Independence" = 2, " " = 2)) %>%
  kable_styling(full_width = F) %>% 
  footnote(general = "Standard errors in parentheses")
```


<br>
```{r, results="asis",echo=FALSE,warning=FALSE,message=FALSE}


tmod1.1stage <- lm(independence.polit.efsa~ 
            treatment+
              ban.pesticide*(
            supports.pesticides +
            organization.type.short),
            data=efsa_00.t1)

tmod.rf.1 <- lm(credibility.pest.considerations~ 
            treatment+
            ban.pesticide*(
            supports.pesticides +
            organization.type.short),
            data=efsa_00.t1) 

reg_iv1 <- ivreg(credibility.pest.considerations~
                   independence.polit.efsa+ 
            ban.pesticide*(
            supports.pesticides +
            organization.type.short)|.-independence.polit.efsa+treatment,data=efsa_00.t1)

tmod.rf.2 <- update(tmod.rf.1, credibility.pest.expertise ~ . ) 



reg_iv2 <- update(reg_iv1, credibility.pest.expertise ~ . )

tmod.rf.3 <- update(tmod.rf.1, credibility.pest.commitment ~ . ) 


reg_iv3 <- update(reg_iv1, credibility.pest.commitment ~ . )



stargazer(tmod1.1stage,
          tmod.rf.1,reg_iv1,
          tmod.rf.2,reg_iv2,
          tmod.rf.3,reg_iv3,
          type="html",
          style = "apsr",
          omit.stat = c("rsq","ser", "f"),
          dep.var.labels=c("Perceived independence",
                           "Considerations",
                           "Expertise",
                           "Commitment"),
          column.labels = c("1st stage (OLS)", "RF (OLS)","IV estimate (2SLS)",
                            "RF (OLS)","IV estimate (2SLS)",
                            "RF (OLS)","IV estimate (2SLS)"),
          model.names = F,
          order = c(3,1,2,4,7,5,6,8,9),
          covariate.labels=c(
            "Ban pesticide (0=approve)",
            "Independence treatment",
            "Perceived independece",
            "Supports pesticides",
            "Industry (ref = other)",
            "NGO (ref = other)",
            "Supports pesticides x Ban pesticide",
            "Industry x Ban pesticide",
            "NGO x Ban pesticide"),
          initial.zero = FALSE,
          notes = "*Notes*: Table entries are non-standardized OLS and 2SLS regression coefficients, with Standard errors in parentheses. The reference category for the organizations is 'other'",
          notes.append = FALSE,
          title = "Table X: Table X: Decision credibility. 2SLS and OLS")

```
&ast;*p*<.1; &ast;&ast;*p*<.05; &ast;&ast;&ast;*p*<.01 (two-tailed).          


<br>




# END












