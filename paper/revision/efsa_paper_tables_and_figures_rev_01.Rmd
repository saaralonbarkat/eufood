---
title: "Testing the link between regulatory agenciesâ€™ independence and credibility: Evidence from a survey experiment with regulatory stakeholders"
author: '**Saar Alon-Barkat**, **Madalina Busuioc** [alphabetical order]'
date: " "
always_allow_html: yes
output:
  html_document:
    theme: flatly
  pdf_document:
    toc: yes
  word_document: default
link-citations: yes
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/chicago-author-date.csl
urlcolor: blue
---

<br>

Draft, last edited at `r Sys.Date()`.

```{r set-global-options, echo = FALSE}
knitr::opts_chunk$set(eval = TRUE, 
                      echo = TRUE, 
                      message=FALSE,
                      warning = FALSE,
                      cache = FALSE,
                      include = TRUE,
                      collapse = FALSE,
                      dependson = NULL,
                      engine = "R", #  Chunks will always have R code, unless noted
                      error = TRUE,
                      fig.path="Figures/",  #  Set the figure options
                      fig.align = "left",
                      fig.width = 6,
                      fig.height = 4)
```




```{r silent-packages, echo = FALSE, eval = TRUE, message=FALSE, include = FALSE}
library(sjPlot)
library(tidyverse)
library(car)
library(reshape2)
library(viridis)
library(ggthemes)
library(corrr)
library(kableExtra)
library(dotwhisker)
library(sjmisc)
library(interflex)
library(effsize)
library(broom)
library(sjstats)
library(stargazer)
library(AER)
library(ggpubr)

```


```{r , include=FALSE, echo=FALSE,warning=FALSE,message=FALSE}
#data

source("G:/My Drive/University/R/EFSA/code/efsa_dm_01.R")#change to your directory path
#source("https://raw.githubusercontent.com/saaralonbarkat/eufood/master/code/efsa_dm_01.R?token=ACU7DGTSVSI2B2UFAE776CC5F3Q3M")


efsa_00.t1 <- efsa_00 %>% 
  drop_na(independence.polit.efsa) %>% 
  data.frame() %>% 
  mutate(approve.pesticide = ban.pesticide %>% Recode("0=1;1=0"))

```

```{r, echo=FALSE, warning=FALSE, message=F}
#Figures and tables
table.x = 0
figure.x = 0
```

<br>

## Figure 1

`r figure.x=figure.x+1` 
**Figure `r figure.x`: Experimental conditions (presentation of a risk assessment of a pesticide)**
![](G:/My Drive/University/R/EFSA/papers/myfigures/manipulations.png)


<br>


## Table 1

`r table.x=table.x+1`
**Table `r table.x`: Balancing table**

```{r, echo=FALSE, warning=FALSE, message=F}

#labels of vars
vars.lab <- c("Trust in European Commission",
              "Trust in European parliament",
              "Trust in Council of European Union",
              "Organization affected by EFSA",
              "Respondent informed about EFSA",
              "Support for pesticides",
              "Gender (Female = 1)")


vars <- c(
  var1 = "trust.eu.commission",
  var2 = "trust.eu.parliament",
  var3 = "trust.eu.council",
  var4 = "affect.decisions.efsa",
  var5 = "informed.efsa",
  var6 = "supports.pesticides",
  var7 = "female"
)




t1.independence <- efsa_00.t1 %>%
  drop_na(treatment) %>%
  mutate(independence.t = ifelse(treatment == 1, "group1", "group0")) %>%
  select(independence.t,!!vars) %>%
  gather(key = variable, value = value,-independence.t) %>%
  group_by(independence.t, variable) %>%
  summarise(value = list(value)) %>%
  spread(independence.t, value) %>%
  group_by(variable) %>%
  
  mutate(
    mean_group0 = round(mean(unlist(group0), na.rm = T), 3),
    mean_group1 = round(mean(unlist(group1), na.rm = T), 3),
    sd_group0 = round(sd(unlist(group0), na.rm = T), 3),
    sd_group1 = round(sd(unlist(group1), na.rm = T), 3),
    t_value.independence = round(t.test(unlist(group1), unlist(group0))$statistic, 3)
  ) %>%
  mutate(
    control = str_c(mean_group0, " (", sd_group0, ")"),
    treatment = str_c(mean_group1, " (", sd_group1, ")")
  ) %>%
  select(variable,
         control,
         treatment,
         t_value.independence) %>%
  as.data.frame() %>%
  arrange(variable) 

t1.pesticide <- efsa_00.t1 %>%
  drop_na(ban.pesticide) %>%
  mutate(ban.pesticide.t = ifelse(ban.pesticide == 1, "group1", "group0")) %>%
  select(ban.pesticide.t,!!vars) %>%
  gather(key = variable, value = value,-ban.pesticide.t) %>%
  group_by(ban.pesticide.t, variable) %>%
  summarise(value = list(value)) %>%
  spread(ban.pesticide.t, value) %>%
  group_by(variable) %>%
  
  mutate(
    mean_group0 = round(mean(unlist(group0), na.rm = T), 3),
    mean_group1 = round(mean(unlist(group1), na.rm = T), 3),
    sd_group0 = round(sd(unlist(group0), na.rm = T), 3),
    sd_group1 = round(sd(unlist(group1), na.rm = T), 3),
    t_value.pesticide = round(t.test(unlist(group1), unlist(group0))$statistic, 3)
  ) %>%
  mutate(
    approve = str_c(mean_group0, " (", sd_group0, ")"),
    ban = str_c(mean_group1, " (", sd_group1, ")")
  ) %>%
  select(variable,
         approve,
         ban,
         t_value.pesticide) %>%
  as.data.frame() %>%
  arrange(variable) 





t3 <- t1.independence %>%
  cbind(t1.pesticide  %>%
          select(-variable))  %>%
  mutate(variable = vars.lab)

```

```{r, echo=FALSE, warning=FALSE, message=F}
t1 =
  efsa_00.t1 %>%
  drop_na(age) %>%
  group_by(treatment, age) %>%
  count() %>%
  spread(treatment, n) %>%
  mutate(t = "") %>%
  ungroup()

t2 =
  efsa_00.t1 %>%
  drop_na(age) %>%
  group_by(ban.pesticide, age) %>%
  count() %>%
  spread(ban.pesticide, n) %>%
  mutate(t = "") %>%
  ungroup() %>%
  select(-age)

t3.age = t1 %>% 
  cbind(t2) %>% 
  data.frame()
colnames(t3.age) = colnames(t3)

t1 <- chisq.test(efsa_00.t1$treatment,efsa_00.t1$age)

t3.age$t_value.independence[1] = str_c("Chi-sq(",t1[["parameter"]][["df"]],")=",t1[["statistic"]][["X-squared"]] %>% round(3))
  
t1 <- chisq.test(efsa_00.t1$ban.pesticide,efsa_00.t1$age)

t3.age$t_value.pesticide[1] = str_c("Chi-sq(",t1[["parameter"]][["df"]],")=",t1[["statistic"]][["X-squared"]] %>% round(3))
t0.age <- t3.age %>% filter(variable==20) %>% 
  mutate(variable = "Age",
         treatment = "",
         control = "",
         t_value.independence = "",
         ban = "",
         approve = "",
         t_value.pesticide = "")


t3 <- t3 %>% 
  rbind(t0.age,
    t3.age)
```

```{r, echo=FALSE, warning=FALSE, message=F}
t1.education = 
  efsa_00.t1 %>%
  drop_na(education) %>% 
  group_by(treatment, education) %>% 
  tally() %>% 
spread(treatment, n) %>% 
  mutate(t="")

t2.education = 
  efsa_00.t1 %>%
  drop_na(education) %>% 
  group_by(ban.pesticide, education) %>% 
  tally() %>% 
spread(ban.pesticide, n) %>% 
  mutate(t="") %>% 
  select(-education)

t3.education = t1.education %>% 
  cbind(t2.education) %>% 
  data.frame()
colnames(t3.education) = colnames(t3)

t1 <- chisq.test(efsa_00.t1$treatment,efsa_00.t1$education)

t3.education$t_value.independence[1] = str_c("Chi-sq(",t1[["parameter"]][["df"]],")=",t1[["statistic"]][["X-squared"]] %>% round(3))
  
t1 <- chisq.test(efsa_00.t1$ban.pesticide,efsa_00.t1$education)

t3.education$t_value.pesticide[1] = str_c("Chi-sq(",t1[["parameter"]][["df"]],")=",t1[["statistic"]][["X-squared"]] %>% round(3))
t0.education <- t3.education %>% filter(variable=="1 High-school") %>% 
  mutate(variable = "Education",
         treatment = "",
         control = "",
         t_value.independence = "",
         ban = "",
         approve = "",
         t_value.pesticide = "")


t4 <- t3 %>% 
  rbind(t0.education,
    t3.education)

t4[is.na(t4)] <- 0

```

```{r, echo=FALSE, warning=FALSE, message=F}
t1.organization.type = 
  efsa_00.t1 %>%
  drop_na(organization.type.short) %>% 
  group_by(treatment, organization.type.short) %>% 
  tally() %>% 
spread(treatment, n) %>% 
  mutate(t="")

t2.organization.type = 
  efsa_00.t1 %>%
  drop_na(organization.type.short) %>% 
  group_by(ban.pesticide, organization.type.short) %>% 
  tally() %>% 
spread(ban.pesticide, n) %>% 
  mutate(t="") %>% 
  select(-organization.type.short)

t3.organization.type = t1.organization.type %>% 
  cbind(t2.organization.type) %>% 
  data.frame()
colnames(t3.organization.type) = colnames(t3)

t1 <- chisq.test(efsa_00.t1$treatment,efsa_00.t1$organization.type.short)

t3.organization.type$t_value.independence[1] = str_c("Chi-sq(",t1[["parameter"]][["df"]],")=",t1[["statistic"]][["X-squared"]] %>% round(3))
  
t1 <- chisq.test(efsa_00.t1$ban.pesticide,efsa_00.t1$organization.type.short)

t3.organization.type$t_value.pesticide[1] = str_c("Chi-sq(",t1[["parameter"]][["df"]],")=",t1[["statistic"]][["X-squared"]] %>% round(3))
t0.organization.type <- t3.organization.type %>% filter(variable=="0-other") %>% 
  mutate(variable = "Organization type",
         treatment = "",
         control = "",
         t_value.independence = "",
         ban = "",
         approve = "",
         t_value.pesticide = "")


t5 <- t4 %>% 
  rbind(t0.organization.type,
    t3.organization.type)

t5[is.na(t5)] <- 0

```


```{r, echo=FALSE, warning=FALSE, message=F}

t5 %>%
  kable(col.names = c("",
                    str_c("Control (n=",                          
                          efsa_00.t1 %>%
                          filter(treatment==0) %>%  
                          nrow(),")"),
                    str_c("Treatment (n=",
                          efsa_00.t1 %>%
                          filter(treatment==1) %>%  
                          nrow(),
                          ")"),
                    "t-test",
                    str_c("Approve pesticide (n=",
                          efsa_00.t1 %>% 
                            filter(ban.pesticide==0) %>%  
                            nrow(),")"),
                    str_c("Ban pesticide (n=",
                          efsa_00.t1 %>% 
                            filter(ban.pesticide==1) %>%  
                            nrow(),")"),
                    "t-test"))%>%
  kable_styling(bootstrap_options = c("condensed"),
                full_width = F,
                position = "left",
                font_size = 9) %>%
  add_header_above(c(" " = 1, 
                     "Independence treatment" = 3,  
                     "Regulatory outcome" = 3))
```
<font size="0.5">

*Notes*: 
Table entries are means with SDs in parentheses, except for categorical variables (age and education). Item scales are -5 to 5. The total Number of respondents in each group includes those who completed the perceived independence item. For some of the variables, the number of respondents may differ due to attrition or avoidance of response.  

</font>

<br>



## Figure 2

`r figure.x=figure.x+1` 
**Figure `r figure.x`: Distributions of perceived policy credibility and independence**


```{r, echo=FALSE, warning=FALSE, message=F}
efsa_00 %>%
  drop_na(ban.pesticide) %>%
  select(credibility.pest.commitment:credibility.pest.expertise,
         independence.polit.efsa,
         ban.pesticide.lab) %>%
  gather("key", "value", -ban.pesticide.lab) %>%
  mutate(
    key = Recode(
      key,
      "'credibility.pest.commitment'='1. Stability';'credibility.pest.expertise'='2. Expert-based';'credibility.pest.considerations'='3. Non-interference'"
    )
  ) %>%
  
  ggplot(aes(
    x = key,
    y = value)) +
  geom_boxplot(width = 0.3) +
  stat_summary(
    fun.data = mean_cl_normal,
    geom = "errorbar",
    fun.args = list(conf.int = 0.95),
    colour = "red",
    alpha = 0.5,
    width = 0.1,
    size = 1,
    position = position_dodge(0.5)
  ) +
  stat_summary(
    fun.y = mean,
    geom = "point",
    colour = "red",
    alpha = 0.5,
    size = 2,
    position = position_dodge(0.5)
  ) +
  scale_y_continuous(limits = c(-5, 5), breaks = -5:5) +
  scale_x_discrete(
    name = "",
    labels = c("Stability",
               "Non-interference",
               "Expert-based",
               "Perceived independence")
  ) +
  ylab("") +
  theme_tufte() +
  labs(title = "",
       subtitle = "",
       caption = "Note: Red dots and bars represent means and 95% CIs") +
  theme(plot.caption = element_text(hjust = 0))
```



<br>



## Table 2

`r table.x=table.x+1`
**Table `r table.x`: Regression analyses for regulatory credibility**

```{r, echo=FALSE,warning=FALSE,message=FALSE}



tmod.considerations.null <- lm(credibility.pest.considerations ~
                                 1,
                               data = efsa_00.t1)


tmod.considerations.1 <- update(tmod.considerations.null, . ~ . +
                                  independence.polit.efsa)
tmod.considerations.2 <- update(
  tmod.considerations.null,
  . ~ . +
    independence.polit.efsa +
    ban.pesticide +
    trust.eu.commission +
    trust.eu.parliament +
    trust.eu.council +
    affect.decisions.efsa +
    informed.efsa
)


tmod.expertise.null <- update(tmod.considerations.null, credibility.pest.expertise ~ . )
tmod.expertise.1 <- update(tmod.considerations.1, credibility.pest.expertise ~ . )
tmod.expertise.2 <- update(tmod.considerations.2, credibility.pest.expertise ~ . )

tmod.commitment.null <- update(tmod.considerations.null, credibility.pest.commitment ~ . )
tmod.commitment.1 <- update(tmod.considerations.1, credibility.pest.commitment ~ . )
tmod.commitment.2 <- update(tmod.considerations.2, credibility.pest.commitment ~ . )

```

```{r, results="asis",echo=FALSE,warning=FALSE,message=FALSE}
control.vars <- c(
  "trust.eu.commission",
  "trust.eu.parliament",
  "trust.eu.council",
  "female",
  "affect.decisions.efsa",
  "informed.efsa",
  "supports.pesticides",
  "organization.type.short"
)

stargazer(
  tmod.commitment.1,tmod.commitment.1,
  tmod.commitment.2,tmod.commitment.2,
  tmod.expertise.1,tmod.expertise.1,
  tmod.expertise.2,tmod.expertise.2,
  tmod.considerations.1,tmod.considerations.1,
  tmod.considerations.2,tmod.considerations.2,
  type = "html",
  report = "vcsp",
  style = "apsr",
  column.labels   = str_c("(1.",1:6,")"),
  column.separate = rep(2,6),
  omit.stat = c("rsq","ser", "f"),
  dep.var.labels = c("Stability",
                     "Expert-based",
                     "Non-interference"),
  covariate.labels = c("Perceived independence"),
  initial.zero = FALSE,
  omit = c(control.vars,"ban.pesticide"),
  add.lines = list(c("Controls", rep(c(
    "No","", "Yes",""
  ), 3))),
  notes = "*Notes*: Table entries are non-standardized OLS-regression coefficients, with Standard errors in parentheses.",
  notes.append = FALSE
)

```

<br>


## Table 3


```{r,echo=FALSE,warning=FALSE,message=FALSE}

  tmod1.1stage <- lm(independence.polit.efsa~ 
                     treatment+
                     ban.pesticide+
                     trust.eu.commission+
                     trust.eu.parliament+
                     trust.eu.council+
                     affect.decisions.efsa+
                     informed.efsa,
                data=efsa_00.t1)

tmod.rf.considerations <- lm(credibility.pest.considerations~ 
                            treatment+
                            ban.pesticide+
                            trust.eu.commission+
                            trust.eu.parliament+
                            trust.eu.council+
                            affect.decisions.efsa+
                            informed.efsa,
                          data=efsa_00.t1) 

reg_iv.considerations <- ivreg(credibility.pest.considerations~
                              independence.polit.efsa+ 
                              ban.pesticide+
                              trust.eu.commission+
                              trust.eu.parliament+
                              trust.eu.council+
                              affect.decisions.efsa+
              informed.efsa|.-independence.polit.efsa+treatment,data=efsa_00.t1)

tmod.rf.expertise <- update(tmod.rf.considerations, credibility.pest.expertise ~ . ) 



reg_iv.expertise <- update(reg_iv.considerations, credibility.pest.expertise ~ . )

tmod.rf.commitment <- update(tmod.rf.considerations, credibility.pest.commitment ~ . ) 


reg_iv.commitment <- update(reg_iv.considerations, credibility.pest.commitment ~ . )

```

```{r, echo=FALSE,warning=FALSE,message=FALSE}

#Beta cpefficients

efsa_00.t1 <- efsa_00.t1 %>% 
  mutate(credibility.pest.considerations.std = scale(credibility.pest.considerations),
         credibility.pest.expertise.std = scale(credibility.pest.expertise),
         credibility.pest.commitment.std = scale(credibility.pest.commitment),
         independence.polit.efsa.std = scale(independence.polit.efsa),
         supports.pesticides.std = scale(supports.pesticides))


  efsa_00.t1.long <-  efsa_00.t1 %>% 
  gather("outcome.var","value",c("credibility.pest.commitment.std",
                                 "credibility.pest.expertise.std",
                                 "credibility.pest.considerations.std")) 

models.observational.std <- 
efsa_00.t1.long %>% 
  group_by(outcome.var) %>% 
  do(fit = lm(
  value ~
    independence.polit.efsa.std +
    ban.pesticide +
    trust.eu.commission +
    trust.eu.parliament +
    trust.eu.council +
    affect.decisions.efsa +
    informed.efsa,
  data = .)) %>%
  tidy(fit) %>% 
  filter(term=="independence.polit.efsa.std") 



tmod1.1stage.std <- lm(independence.polit.efsa.std~ 
                   treatment+
                   ban.pesticide+
                   trust.eu.commission+
                   trust.eu.parliament+
                   trust.eu.council+
                   affect.decisions.efsa+
                   informed.efsa,
                data=efsa_00.t1)

models.rf.std <- 
efsa_00.t1.long %>% 
  group_by(outcome.var) %>% 
  do(fit = lm(
  value ~
    treatment +
    ban.pesticide +
    trust.eu.commission +
    trust.eu.parliament +
    trust.eu.council +
    affect.decisions.efsa +
    informed.efsa,
  data = .)) %>%
  tidy(fit) %>% 
  filter(term=="treatment") 

models.iv.std <- 
efsa_00.t1.long %>% 
  group_by(outcome.var) %>% 
  do(fit = ivreg(value ~
                              independence.polit.efsa.std+ 
                              ban.pesticide+
                              trust.eu.commission+
                              trust.eu.parliament+
                              trust.eu.council+
                              affect.decisions.efsa+
              informed.efsa|.-independence.polit.efsa.std+treatment,data= .)) %>%
  tidy(fit) %>% 
  filter(term=="independence.polit.efsa.std") %>% 
  mutate(term = Recode(term,"'independence.polit.efsa.std' = 'independence.polit.efsa.iv.std'"))

models <- rbind(models.observational.std,
                models.rf.std,
                models.iv.std)

t1 <- models.iv.std %>% 
  data.frame() %>% 
  mutate(lower = estimate - 1.96*std.error,
         upper = estimate + 1.96*std.error)
```


`r table.x=table.x+1`
**Table `r table.x`: Instrumental Variable regression analyses**

```{r, results="asis",echo=FALSE,warning=FALSE,message=FALSE}

control.vars <- c("trust.eu.commission", 
          "trust.eu.parliament",
          "trust.eu.council",
          "female",
          "affect.decisions.efsa", 
          "informed.efsa",
          "supports.pesticides",
          "organization.type.short")

stargazer(tmod1.1stage,tmod1.1stage,
          tmod.rf.commitment,tmod.rf.commitment,
          reg_iv.commitment,reg_iv.commitment,
          tmod.rf.expertise,tmod.rf.expertise,
          reg_iv.expertise,reg_iv.expertise,
          tmod.rf.considerations,tmod.rf.considerations,
          reg_iv.considerations,reg_iv.considerations,
          type="html",
          style = "apsr",
          omit.stat = c("rsq","ser", "f"),
          dep.var.labels=c("Perceived independence",
                           "Stability",
                           "Expert-based",
                           "Non-interference"),
          covariate.labels=c("Independence treatment",
                             "Perceived independence"),
          column.labels = c("(2.1) 1st stage (OLS)","", 
                            "(2.2) RF (OLS)","",
                            "(2.3) IV estimate (2SLS)","",
                            "(2.4) RF (OLS)","",
                            "(2.5) IV estimate (2SLS)","",
                            "(2.6) RF (OLS)","",
                            "(2.7) IV estimate (2SLS)",""),
          report = "vcsp",
          model.names = F,
          omit = c(control.vars,"ban.pesticide"),
          add.lines = list(c("Covariates", rep("Yes",14))),
          initial.zero = FALSE,
          notes = "*Notes*: Table entries are non-standardized OLS and 2SLS regression coefficients, with Standard errors in parentheses.",
          notes.append = FALSE)

```

<br>

## Figure XX

`r figure.x=figure.x+1` 
**Figure `r figure.x`: The effect of independence manipulation on the perceived independence of EFSA**


```{r, echo=FALSE,warning=FALSE,message=FALSE}
efsa_00 %>% 
  drop_na(independence.polit.efsa) %>% 
  ggplot(aes(x=independence.polit.efsa,fill=treatment.lab)) +
  geom_bar(width = 0.75,alpha=0.8, position = position_dodge())+
  scale_x_continuous(name="",limits = c(-6,6),breaks = -5:5)+
#  scale_fill_manual(name = "Independence condition", values = c("dodgerblue2","dodgerblue4"))+
  scale_fill_viridis_d(name = "Independence condition")+
  theme_tufte()  +
  theme(plot.caption = element_text(hjust = 0))+
    theme(legend.position = c(0.80, 0.85),
        legend.background = element_rect(size=0.5, linetype="solid",color = "gray75"))
```


<br>


## Figure 3

`r figure.x=figure.x+1` 
**Figure `r figure.x`: Coefficients plot -- the effect of perceived independence on policy credibility**

```{r, echo=FALSE,warning=FALSE,message=FALSE}
t1 <- models %>% 
  mutate(model = outcome.var %>% Recode("'credibility.pest.commitment.std'='1. Stability';
        'credibility.pest.expertise.std'='2. Expert-based';
        'credibility.pest.considerations.std'='3. Non-interference'")) %>% arrange(desc(model))

t1 %>% 
  dwplot(dodge_size=0.2,
                dot_args = list(size = 3),
  whisker_args = list(size = 0.7),
  vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2))%>% 
      relabel_predictors(c(independence.polit.efsa.std = "Observational",
                         independence.polit.efsa.iv.std = "Instumental variable (IV)", 
                         treatment = "Independence treatment (RF)")) +
    scale_x_continuous(limits = c(-0.5,1.1),breaks = seq(-0.75,1,0.25))+
  theme_tufte()+
  scale_color_viridis_d(name = "Outcome variable", guide = guide_legend(reverse=TRUE),labels = c("Non-interference","Expert-based","Stability"))+
  labs(title = "",
       subtitle = "",
       caption = "Note: Standardized coefficients and 95% CIs are extracted from regression models with controls.") +
  theme(plot.caption = element_text(hjust = 0))+
    theme(legend.position = c(0.85, 0.9),
        legend.background = element_rect(size=0.5, linetype="solid",color = "gray75"))
```

<br>

## Figure 4

`r figure.x=figure.x+1` 

**Figure `r figure.x`: Policy credibility across regulatory outcomes**


```{r, echo=FALSE, warning=FALSE, message=F, fig.width=6}
efsa_00 %>%
  drop_na(ban.pesticide) %>%
  select(credibility.pest.commitment:credibility.pest.expertise,
         ban.pesticide.lab) %>%
  gather("key", "value", -ban.pesticide.lab) %>%
  mutate(
    key = Recode(
      key,
      "'credibility.pest.commitment'='1. Stability';'credibility.pest.considerations'='2. Non-interference';'credibility.pest.expertise'='3. Expert-based'"
    )
  ) %>%
  
  ggplot(aes(
    x = key,
    y = value,
    color = ban.pesticide.lab,
    shape = ban.pesticide.lab
  )) +
  geom_boxplot(width = 0.5) +
  stat_summary(
    fun.data = mean_cl_normal,
    geom = "errorbar",
    fun.args = list(conf.int = 0.95),
    colour = "red",
    alpha = 0.5,
    width = 0.1,
    size = 1,
    position = position_dodge(0.5)
  ) +
  stat_summary(
    fun.y = mean,
    geom = "point",
    colour = "red",
    alpha = 0.5,
    size = 2,
    position = position_dodge(0.5)
  ) +
  scale_y_continuous(limits = c(-5, 5), breaks = -5:5) +
  scale_x_discrete(
    name = "",
    labels = c("Stability",
               "Non-interference",
               "Expert-based")
  ) +
  scale_shape_manual(
    name = "Regulatory outcome",
    values = c(19, 1),
    labels = c("Approve pesticide", "Ban pesticide")
  ) +
  scale_color_manual(
    name = "Regulatory outcome",
    values = c("gray10", "gray60"),
    labels = c("Approve pesticide", "Ban pesticide")
  ) +
  ylab("") +
  theme_tufte() +
  labs(title = "",
       subtitle = "",
       caption = "Note: Red dots and bars represent means and 95% CIs") +
  theme(plot.caption = element_text(hjust = 0),
        legend.background = element_rect(size=0.5, linetype="solid",color = "gray75"))

```

<br>

## Figure 5

`r figure.x=figure.x+1`
**Figure `r figure.x`: Prior beliefs regarding pesticides across stakeholder groups**
```{r, echo=FALSE, warning=FALSE, message=F, fig.width=4}
t1 <- efsa_00 %>%
  group_by(organization.type.short) %>% 
  summarise(n())


efsa_00 %>%
  drop_na(organization.type.short) %>% 
  mutate(organization.type.short.t = Recode(organization.type.short,"'0-other'='3-other';'2-ngo'='0-ngo'")) %>% 
  ggplot(aes(x=organization.type.short.t,y=supports.pesticides))+
  geom_boxplot(width = 0.5)+
      stat_summary(fun.data = mean_cl_normal, fun.args=list(conf.int=0.95), geom = "errorbar", colour = "red",alpha=0.5,width=0.1,size=1,position=position_dodge(0.5)) + 
  stat_summary(fun.y = mean, geom = "point", colour = "red",alpha=0.5,size=2,position=position_dodge(0.5))+
  scale_y_continuous(name="Support for pesticides",limits = c(-5,5),breaks=-5:5)+
  scale_x_discrete(name="",labels = c("NGOs\n(n=65)","Industry\n(n=106)","Other\n(n=99)"))+
  theme_tufte()+
  labs(title = "",
              subtitle = "",
              caption = "Note: Red dots and bars represent means and 95% CIs")+
  theme(
  plot.caption = element_text(hjust = 0)
  )
```
<br>


<br>

## Table 4

`r table.x=table.x+1`

```{r, echo=FALSE,warning=FALSE,message=FALSE}


tmod.considerations.11 <- update(tmod.considerations.2, . ~ . + 
                      supports.pesticides)
tmod.considerations.12 <- update(tmod.considerations.2, . ~ . + 
                      ban.pesticide*supports.pesticides)

tmod.expertise.11 <- update(tmod.expertise.2, . ~ . + 
                      supports.pesticides)
tmod.expertise.12 <- update(tmod.expertise.2, . ~ . + 
                      ban.pesticide*supports.pesticides)

tmod.commitment.11 <- update(tmod.commitment.2, . ~ . + 
                      supports.pesticides)
tmod.commitment.12 <- update(tmod.commitment.2, . ~ . + 
                      ban.pesticide*supports.pesticides)

```

**Table `r table.x`: Regression analyses for regulatory credibility**
```{r, results="asis",echo=FALSE,warning=FALSE,message=FALSE}
control.vars <- c("trust.eu.commission", 
          "trust.eu.parliament",
          "trust.eu.council",
          "female",
          "affect.decisions.efsa", 
          "informed.efsa")

stargazer(tmod.commitment.11,tmod.commitment.11,
          tmod.commitment.12,tmod.commitment.12,
          tmod.expertise.11,tmod.expertise.11,
          tmod.expertise.12,tmod.expertise.12,
          tmod.considerations.11,tmod.considerations.11,
          tmod.considerations.12,tmod.considerations.12,
          type="html",
          report = "vcsp",
          style = "apsr",
          column.labels   = str_c("(3.",1:6,")"),  
          column.separate = rep(2,6),
          omit.stat = c("rsq","ser", "f"),
          dep.var.labels=c("Stability",
                           "Expert-based",
                           "Non-interference"),
          covariate.labels=c(
            "Perceived independence",
            "Ban pesticide (0=approve)",
            "Supports pesticides",
            "Supports pesticides x Ban pesticide"),
          initial.zero = FALSE,
          omit = control.vars,
          add.lines = list(c("Controls",rep("Yes",12))),
          notes = "*Notes*: Table entries are non-standardized OLS-regression coefficients, with Standard errors in parentheses.",
          notes.append = FALSE)
```


```{r}
#BETAs

models.priors.std <- 
efsa_00.t1.long %>% 
  group_by(outcome.var) %>% 
  do(fit = lm(
  value ~
    independence.polit.efsa.std +
    trust.eu.commission +
    trust.eu.parliament +
    trust.eu.council +
    affect.decisions.efsa +
    informed.efsa +
    ban.pesticide*supports.pesticides.std,
  data = .)) %>%
  tidy(fit) %>% 
  data.frame() %>%
  mutate(lower = round(estimate - 1.96*std.error,2),
         upper = round(estimate + 1.96*std.error,2))


models.priors.std %>% 
  filter(term=="independence.polit.efsa.std") 

```


<br>

## Figure 6

`r figure.x=figure.x+1` 

**Figure `r figure.x`: Interaction between ban opinion and support for pesticides**

```{r,echo=FALSE,warning=FALSE,message=FALSE}
df.predict <- data.frame(
  supports.pesticides = rep(-5:5,2),
  ban.pesticide = rep(0:1,each=11),
  independence.polit.efsa = rep(mean(efsa_00.t1$independence.polit.efsa,na.rm = T),22),
  trust.eu.commission = rep(mean(efsa_00.t1$trust.eu.commission,na.rm = T),22),
  trust.eu.parliament = rep(mean(efsa_00.t1$trust.eu.parliament,na.rm = T),22),
  trust.eu.council = rep(mean(efsa_00.t1$trust.eu.council,na.rm = T),22),
  affect.decisions.efsa = rep(mean(efsa_00.t1$affect.decisions.efsa,na.rm = T),22),
  informed.efsa = rep(mean(efsa_00.t1$informed.efsa,na.rm = T),22)
) 

df.predict.commitment <- predict(tmod.commitment.12,df.predict,interval = 'confidence') %>% data.frame() %>% mutate(outcome.var = "credibility.pest.commitment") %>% cbind(df.predict)

df.predict.expertise <- predict(tmod.expertise.12,df.predict,interval = 'confidence') %>% data.frame() %>% mutate(outcome.var = "credibility.pest.expertise") %>% cbind(df.predict)

df.predict.considerations <- predict(tmod.considerations.12,df.predict,interval = 'confidence') %>% data.frame() %>% mutate(outcome.var = "credibility.pest.considerations") %>% cbind(df.predict)

df.predict.1 <- 
  rbind(df.predict.commitment,
        df.predict.expertise,
        df.predict.considerations)

```

```{r, fig.width=8,echo=FALSE,warning=FALSE,message=FALSE}
p1 <- df.predict.1 %>% 
  filter(outcome.var == "credibility.pest.commitment") %>% 
  ggplot(aes(x = supports.pesticides, y = fit,color = factor(ban.pesticide))) +
  geom_line(size = 1) + 
geom_line(aes(x = supports.pesticides, y = lwr), 
            linetype = 2) +
  geom_line(aes(x = supports.pesticides, y = upr), 
            linetype = 2)+
  scale_y_continuous(name = "Stability",limits = c(-3,5),breaks = -3:5)+
  scale_x_continuous(name = "Support for pesticides",limits = c(-5,5),breaks = -5:5)+
  scale_color_manual(name="Regulatory outcome",
    values = c("gray1","gray70"),
    guide = guide_legend(reverse=TRUE))+
  theme_tufte()+
  theme(legend.position = "none")

p2 <- df.predict.1 %>% 
  filter(outcome.var == "credibility.pest.expertise") %>% 
  ggplot(aes(x = supports.pesticides, y = fit,color = factor(ban.pesticide))) +
  geom_line(size = 1) + 
geom_line(aes(x = supports.pesticides, y = lwr), 
            linetype = 2) +
  geom_line(aes(x = supports.pesticides, y = upr), 
            linetype = 2)+
  scale_y_continuous(name = "Expert-based",limits = c(-3,5),breaks = -3:5)+
  scale_x_continuous(name = "Support for pesticides",limits = c(-5,5),breaks = -5:5)+
  scale_color_manual(name="Regulatory outcome",
    values = c("gray1","gray70"),
    guide = guide_legend(reverse=TRUE))+
  theme_tufte()+
  theme(legend.position = "none")

p3 <- df.predict.1 %>% 
  filter(outcome.var == "credibility.pest.considerations") %>% 
  ggplot(aes(x = supports.pesticides, y = fit,color = factor(ban.pesticide))) +
  geom_line(size = 1) + 
geom_line(aes(x = supports.pesticides, y = lwr), 
            linetype = 2) +
  geom_line(aes(x = supports.pesticides, y = upr), 
            linetype = 2)+
  scale_y_continuous(name = "Non-interference",limits = c(-3,5),breaks = -3:5)+
  scale_x_continuous(name = "Support for pesticides",limits = c(-5,5),breaks = -5:5)+
  scale_color_manual(name="Outcome",
    values = c("gray1","gray70"),
    labels = c("Approve", "Ban"),
    guide = guide_legend(reverse=TRUE))+
  theme_tufte()+
    theme(legend.position = c(0.75, 0.85),
        legend.background = element_rect(size=0.5, linetype="solid",color = "gray75"),
         legend.title = element_text(size = 12),
  legend.text = element_text(size = 12))
  


ggarrange(p1,p2,p3,
          ncol = 3,nrow = 1)

```

































