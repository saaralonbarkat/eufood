---
title: "SVIVA_experiment 2"
author: "Saar Alon-Barkat"
date: "January 2018"
output:
  html_document:
    code_folding: hide
    fig_captions: yes
    highlight: haddock
    number_sections: yes
    theme: flatly
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
      toc_depth: 3
  pdf_document:
    toc: yes
---



Last update: `r Sys.time()`


```{r set-global-options, echo = FALSE}
knitr::opts_chunk$set(eval = TRUE, 
                      echo = TRUE, 
                      message=FALSE,
                      warning = FALSE,
                      cache = FALSE,
                      include = TRUE,
                      collapse = FALSE,
                      dependson = NULL,
                      engine = "R", # Chunks will always have R code, unless noted
                      error = TRUE,
                      fig.path="Figures/",  # Set the figure options
                      fig.align = "left",
                      fig.width = 4,
                      fig.height = 4)
```


```{r silent-packages, echo = FALSE, eval = TRUE, message=FALSE, include = FALSE}
library(sjPlot)
library(tidyverse)
library(car)
library(reshape2)
library(viridis)
library(ggthemes)
library(corrr)
library(kableExtra)
library(dotwhisker)
```


```{r}
source("efsa_dm_01.R")
```

#Survey

##Independence treatment
<br>
**Control:**

>EFSA is a EU regulatory agency that was set up to be a source of advice and communication on risks associated with the food chain.       The agency was legally established in 2002 under the General Food Law - Regulation (EC) 178/2002. It is responsible for risk assessment and also has a duty to communicate its scientific findings to the public. 
According to its founding regulation, EFSA is to “provide scientific advice and... support for the Community's legislation and policies” and is expected to “act in close collaboration with the Commission and the Member States to promote the necessary coherence in the risk communication process.” The regulation specifies EFSA´s legal mandate, as well as its organizational, financial, and regulatory arrangements. 
EFSA acknowledges the importance of the effective communication of its opinions to decision‐makers and the general public, and has developed specific policies for this purpose.         

<br>

**Treatment:** 

>EFSA is a EU regulatory agency that operates independently of the European Commission, the European Parliament, and the Member States.      
According to its founding regulation (Regulation (EC) No 178/2002), EFSA is “to serve as a point of reference by virtue of its independence” and the members of its scientific committee and panels “shall undertake to act independently of any external influence”. The regulation establishes the agency's legal, financial, and regulatory independence. EFSA's opinions are based solely on judgments of independent scientists, without any intervention by the agency’s board or any other political bodies.      
Moreover, EFSA explicitly acknowledges the independence of its experts, methods and data from any external influence as one of its key organizational values, and has developed specific policies to ensure their impartiality and neutrality.         

<br>

##Pesticide cases
<br>
**High risk (Amitrole):**

>In 2015, EFSA submitted its conclusion on the risk assessment of the pesticide "Amitrole", which has been widely used as a weedkiller in orchards, grapes, olives and for non-crop uses. EFSA was asked by the European Commission to evaluate the safety of this pesticide before making a decision about the renewal of its approval.
On the basis of the available data, EFSA identified critical areas of concern regarding the use of Amitrole. A high risk to operators, workers and bystanders from the use of Amitrole was identified. Additionally, EFSA concluded in its review that there is a high potential for groundwater exposure by toxic substances above the acceptable limit, as well as noting that Amitrole should be considered to have endocrine disrupting properties  (i.e. interferes with the hormone system). Finally, in its conclusion, it indicated that during the peer review it was proposed that Amitrole should be re-classified to a higher hazard category as “presumed human reproductive toxicant”. Substances are classified in this category when data provides clear evidence of an adverse effect for instance, on sexual function and fertility.  
Based on EFSA's conclusions about these identified high risks, the pesticide Amitrole has been banned. 

<br>

**Low risk (Flupyradifurone):**

>In 2015, EFSA submitted its conclusion on the risk assessment of the pesticide "Flupyradifurone", a new active substance, which has been developed for protecting various crops against insects such as aphids, hoppers and whiteflies. EFSA was asked by the European Commission to evaluate the safety of this pesticide before making a decision about its approval. 
On the basis of the available data, EFSA concluded in its report that Flupyradifurone is not carcinogenic nor toxic for reproduction. It also noted that the conditions for the consideration of endocrine disrupting properties for human health (i.e. interferes with the hormone system) were not met. However, EFSA also noted that the information available was insufficient to entirely rule out the potential for endocrine disrupting effects of the pesticide. Also, it could not completely rule out the risk for consumers due to the unknown nature of residues that might be present in drinking water. In the end, EFSA did not propose to classify the pesticide as toxic, and concluded that it may be expected to fulfil the safety requirements laid down in the legislation. 
Based on EFSA's conclusions, the pesticide Flupyradifurone has been approved.     

<br>
   



<br>

#Response rate
```{r}
n.invitations = 156
n.errors = 6
n.invitations_effective = n.invitations-n.errors

n.open.link = efsa_raw_00 %>% nrow()
n.start = efsa_00 %>% nrow()
n.reach_cases = efsa_00 %>% drop_na(condition) %>% nrow()
n.reach_independence = efsa_00 %>% drop_na(idependence.polit.efsa) %>% nrow()
n.reach_agencies = efsa_raw %>% filter(Q12.1 ==1)%>% nrow()
n.reach_demographics = efsa_raw %>% filter(Q13.1 ==1)%>% nrow()
n.reach_end = efsa_raw %>% filter(Q13.13 !=0)%>% nrow()

response.df <- data.frame(category = c("Total Invitations",
                                       "Effective invitations",
                                       "Openned survey",
                                       "Started survey",
                                       "Reached pesticide cases",
                                       "Reached independence question",
                                       "Reached agencies questions",
                                       "Reached demographics",
                                       "Finished")) %>% 
                mutate(n=c(n.invitations,
                            n.invitations_effective,
                            n.open.link,
                            n.start,
                            n.reach_cases,
                            n.reach_independence,
                            n.reach_agencies,
                            n.reach_demographics,
                            n.reach_end)) %>% 
  mutate(response.rate = paste0(((n/n.invitations_effective*100)%>% round(1)),"%"),
         attrition.rate = paste0(((n/n.start*100)%>% round(1)),"%"))

response.df %>% 
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F)
```


```{r}
response.df %>% 
  filter(!(category %in% c("Total Invitations","Effective invitations"))) %>% 
ggplot(aes(reorder(category,n,desc),n))+
  geom_bar(stat="identity",width = 0.75,fill="dodgerblue2",alpha=0.8)+
  #scale_y_continuous(limits = c(0,nrow(t1)/4),breaks = 1:20)+
  scale_x_discrete(name = "")+
  theme_tufte()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```


<br>

#Time

```{r,fig.width=6}
efsa_00 <- efsa_00 %>% 
  mutate(timer = (end.date-start.date) %>% as.numeric(),
         x=1) 


  efsa_00 %>% 
  filter(timer<=360) %>% 
    drop_na(comprehension.check) %>%
ggplot(aes(x=x,y=timer))+
  geom_boxplot(width = 0.1)+
  geom_jitter(height = 0.2,width = 0 ,size=2,colour="dodgerblue2",alpha=0.6)+
    scale_y_continuous(name = "Minutes",breaks = seq(0,3600,5))+
    scale_x_discrete(name = "")+
  ggtitle("Completion time of Survey")+
  coord_flip()+
  theme_tufte()
 
```





#Experimental conditions

<br>

**Simulated dataset**

First, to test random assignment by Qualtrics software, I generated automatic random test responses of n=2000.  
```{r}
source("efsa_dm_simulation_01.R")

sjp.frq(efsa_00.s$condition,
        ylim = c(0,nrow(efsa_00.s)/2),
        axis.title = "",
        geom.size = 0.65,
        geom.colors = alpha("dodgerblue2",0.8))+
        #axis.labels = c("Control","Treatment"),
        #title = "Independence treatment")+ 
  #coord_flip()+
  theme_tufte()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```



**Real dataset**
<br>
Now, the real data:
```{r}
sjp.frq(efsa_00$treatment,
        ylim = c(0,nrow(efsa_00)),
        axis.title = "",
        geom.size = 0.65,
        geom.colors = alpha("dodgerblue2",0.8),
        axis.labels = c("Control","Treatment"),
        title = "Independence treatment")+ 
  theme_tufte()
```


Pesticide case
```{r}

sjp.frq(efsa_00$high.risk,
        ylim = c(0,nrow(efsa_00)),
        axis.title = "",
        geom.size = 0.65,
        geom.colors = alpha("dodgerblue2",0.8),
        axis.labels = c("Low risk","High risk"),
        title = "Pesticide case")+ 
  theme_tufte()

```

<br>

```{r}
sjp.frq(efsa_00$condition,
        ylim = c(0,nrow(efsa_00)),
        axis.title = "",
        geom.size = 0.65,
        geom.colors = alpha("dodgerblue2",0.8))+
        #axis.labels = c("Control","Treatment"),
        #title = "Independence treatment")+ 
  #coord_flip()+
  theme_tufte()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```


<br>

#Descriptive statistics

##Demographics

**Age**

[measured by 10 years intervals]

<br>
```{r}
sjp.frq(efsa_00$age,
        ylim = c(0,nrow(efsa_00)/2),
        geom.colors = alpha("dodgerblue2",0.8),
        title = "Participant age group")+ 
  theme_tufte()
```


**Gender**
<br>
```{r}
sjp.frq(efsa_00$female,
        ylim = c(0,nrow(efsa_00)),
        geom.colors = alpha("dodgerblue2",0.8),
        axis.labels = c("Male","Female"),
        title = "Participant gender")+ 
  theme_tufte()
```

**Education**
<br>
```{r}
sjp.frq(efsa_00$education,
        ylim = c(0,nrow(efsa_00)),
        geom.colors = alpha("dodgerblue2",0.8),
        title = "Participant education level")+ 
  theme_tufte()
```
<br>
**Discipline**

TBA

<br>

**Native language**

```{r}
select(efsa_00,1) %>%
  mutate(native.language.english = ifelse(efsa_raw$Q13.7==1,1,NA),
         native.language.French = ifelse(efsa_raw$Q13.8_1==1,1,NA),
         native.language.German = ifelse(efsa_raw$Q13.8_2==1,1,NA),
         native.language.Spanish = ifelse(efsa_raw$Q13.8_4==1,1,NA),
         native.language.Italian = ifelse(efsa_raw$Q13.8_5==1,1,NA),
         native.language.Dutch = ifelse(efsa_raw$Q13.8_6==1,1,NA),
         native.language.Portuguese = ifelse(efsa_raw$Q13.8_7==1,1,NA),
         native.language.other = efsa_raw$Q13.8_8_TEXT) ->
    t1

t2 <- data.frame(language = c("English",
                                   "French",
                                   "German",
                                   "Spanish",
                                   "Italian",
                                   "Dutch",
                                   "Portuguese",
                                   "other")) %>% 
  mutate(n = c(filter(t1,native.language.english==1) %>% nrow(),
                        filter(t1,native.language.French==1) %>% nrow(),
                        filter(t1,native.language.German==1) %>% nrow(),
                        filter(t1,native.language.Spanish==1) %>% nrow(),
                        filter(t1,native.language.Italian==1) %>% nrow(),
                        filter(t1,native.language.Dutch==1) %>% nrow(),
                        filter(t1,native.language.Portuguese==1) %>% nrow(),
                        filter(t1,native.language.other !=0) %>% nrow())) %>% 
  mutate(percentage = (n/nrow(t1)) %>% round(2))

ggplot(t2,aes(reorder(language,n,desc),n))+
  geom_bar(stat="identity",width = 0.75,fill="dodgerblue2",alpha=0.8)+
  scale_y_continuous(limits = c(0,nrow(t1)/4),breaks = 1:20)+
  scale_x_discrete(name = "")+
  coord_flip()+
  theme_tufte()
```

*Note: a participant may report more than one native language. 
<br>

Other langauges:
```{r}
filter(t1,!(native.language.other %in% c(0,1,NA)))$native.language.other %>% 
  frq(out="v")
```




##Background about organizations

**Policy domain**
```{r}
select(efsa_00,1) %>%
  mutate(organization.area.1 = ifelse(efsa_raw$Q1.5_1==1,1,NA),
         organization.area.2 = ifelse(efsa_raw$Q1.5_2==1,1,NA),
         organization.area.3 = ifelse(efsa_raw$Q1.5_3==1,1,NA),
         organization.area.4 = ifelse(efsa_raw$Q1.5_4==1,1,NA),
         organization.area.5 = ifelse(efsa_raw$Q1.5_5==1,1,NA),
         organization.area.6 = ifelse(efsa_raw$Q1.5_6==1,1,NA),
         organization.area.other = efsa_raw$Q1.5_7_TEXT) ->
  t1


t2 <- data.frame(area = c("Environment",
                                   "Telecommunications",
                                   "Food and Agriculture",
                                   "Health",
                                   "Financial services",
                                   "Energy",
                                   "other")) %>% 
  mutate(n = c(filter(t1,organization.area.1==1) %>% nrow(),
                        filter(t1,organization.area.2==1) %>% nrow(),
                        filter(t1,organization.area.3==1) %>% nrow(),
                        filter(t1,organization.area.4==1) %>% nrow(),
                        filter(t1,organization.area.5==1) %>% nrow(),
                        filter(t1,organization.area.6==1) %>% nrow(),
                        filter(t1,organization.area.other !=0) %>% nrow())) %>% 
  mutate(percentage = (n/nrow(t1)) %>% round(2))


ggplot(t2,aes(reorder(area,n,desc),n))+
  geom_bar(stat="identity",width = 0.75,fill="dodgerblue2",alpha=0.8)+
  scale_y_continuous(breaks = seq(0,nrow(t1),5))+
  scale_x_discrete(name = "")+
  coord_flip()+
  theme_tufte()

```
<br>

**Organization type**
```{r, fig.width=6}

efsa_00 %>% 
  group_by(organization.type.raw) %>% 
  tally() %>% 
  
  ggplot(aes(reorder(organization.type.raw,n,desc),n))+
  geom_bar(stat="identity",width = 0.75,fill="dodgerblue2",alpha=0.8)+
  scale_y_continuous(breaks = seq(0,nrow(efsa_00),1))+
  scale_x_discrete(name = "")+
  coord_flip()+
  theme_tufte()

```


<br>

##Attitudes about EU institutions

<br>
To what extent do you trust the following EU institutions?
<br>

```{r, fig.width=6,fig.height=3}
efsa_00 %>% 
  select(trust.eu.commission,
         trust.eu.parliament,
         trust.eu.council) %>% 
  gather() %>% 
  mutate(key = key %>% Recode("'trust.eu.commission' = 'European Commission';
                                            'trust.eu.parliament' = 'European Parliament ';
                                            'trust.eu.council' = 'Council of the European Union'")) %>% 
ggplot(aes(x=value,fill=key))+geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte() 

```

<br>

```{r}
efsa_00 %>% 
select(trust.eu.commission,
       trust.eu.parliament,
       trust.eu.council) %>% 
  sjt.corr(triangle = "lower",show.p=T,p.numeric=T)
```

<br>

##Attitudes about EU agencies

<br>

Below is a list of selected EU agencies [that operate independently of the EU political institutions].  
To what extent do you perceive these agencies to be credible regulators?
<br>
```{r}

efsa_00 %>% 
  select(credibility.eea.pre,
         credibility.efsa.pre,
         credibility.ema.pre,
         credibility.echa.pre) %>% 
  gather() %>% 
  mutate(key = key %>% Recode("'credibility.eea.pre' = 'EEA';'credibility.efsa.pre' = 'EFSA'; 'credibility.ema.pre' = 'EMA';'credibility.echa.pre' = 'ECHA'")) %>% 
ggplot(aes(x=value,fill=key))+geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte()

```
<br>

```{r}
efsa_00 %>% 
select(credibility.eea.pre,
       credibility.efsa.pre,
       credibility.ema.pre,
       credibility.echa.pre) %>% 
  sjt.corr(triangle = "lower",show.p=T,p.numeric=T)
```

<br>

##Moderators

<br>
Some people argue that most private companies and corporations do not care about the social consequences of their actions and products. They are only interested in maximizing their short-term profits.
<br>

```{r,fig.height=3}
efsa_00 %>% 
  select(greediness.industry,
         greediness.food.industry) %>% 
  gather() %>% 
  mutate(key = key %>% Recode("'greediness.industry' = 'In general';'greediness.food.industry' = 'In food industry'")) %>% 
ggplot(aes(x=value,fill=key))+geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte()


```


<br>

New technologies often spark debate about the opportunities they bring versus the threats they pose. This also applies in the EU policy context.

For each of the following technologies, please indicate whether you believe that their implementation mainly brings benefits and opportunities, or rather poses a threat:

<br>
```{r, fig.width=6}

efsa_00 %>% 
  select(supports.gmo,
         supports.pesticides,
         supports.additives) %>% 
  gather() %>% 
  mutate(key = key %>% Recode("'supports.gmo' = 'Genetically modified foods';'supports.pesticides' = 'Use of pesticides'; 'supports.additives' = 'Artificial food additives'")) %>% 
ggplot(aes(x=value,fill=key))+geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte()

```
<br>

```{r}
efsa_00 %>% 
ggplot(aes(greediness.food.industry,
           supports.pesticides))+
  geom_jitter(width = 0.05,height = 0.05,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  #scale_x_continuous(name="Perceived independence (5=high)",breaks=-5:5)+
  #scale_y_continuous(name = "Perceived creibility (pre manipulation)",breaks=-5:5)+
  ggtitle("")+
  theme_tufte()
```

<br>
```{r}
efsa_00 %>% 
select(greediness.industry,
       greediness.food.industry,
       supports.gmo,
       supports.pesticides,
       supports.additives) %>% 
  sjt.corr(triangle = "lower",show.p=T,p.numeric=T)
```

<br>
```{r}
t1 <- efsa_00 %>% 
select(greediness.food.industry,
       supports.gmo,
       supports.pesticides,
       supports.additives) %>%
  mutate(greediness.food.industry = -1*greediness.food.industry)
t1 %>% 
sjt.itemanalysis()
```

<br>
```{r}
efsa_00 <- efsa_00 %>% 
  mutate(prior.beliefs.food = (-1*greediness.food.industry+
                                supports.gmo+
                                supports.pesticides+
                                supports.additives)/4)


sjp.frq(efsa_00$prior.beliefs.food,
        type="histogram",
        geom.colors = alpha("dodgerblue2",0.8),
        geom.size = 1,
        show.mean = T)+
  theme_tufte()

```

<br>
```{r, fig.width=6}
ggplot(efsa_00,aes(prior.beliefs.food,organization.type.raw))+
  geom_jitter(height = 0,size=2,colour="dodgerblue2",alpha=0.6)+
  scale_x_continuous(name="Index - prior beliefs about food industry",limits = c(-6,6),breaks = -5:5)+
  theme_tufte()
  
```

<br>

##Relations with efsa (and other agencies)
<br>
I am well informed about the agency's mandate.
<br>
```{r}
efsa_00 %>% 
  select(informed.eea:informed.efsa) %>% 
  gather() %>% 
  mutate(key = key %>% Recode("'informed.eea' = 'EEA';'informed.ema' = 'EMA';'informed.echa' = 'ECHA';'informed.efsa' = 'EFSA'")) %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte()

```

<br>
The agency’s decisions may affect the operations of the organization in which I work.
<br>
```{r}
efsa_00 %>% 
  select(affect.decisions.eea:affect.decisions.efsa) %>% 
  gather() %>% 
  mutate(key = key %>% Recode("'affect.decisions.eea' = 'EEA';'affect.decisions.ema' = 'EMA';'affect.decisions.echa' = 'ECHA';'affect.decisions.efsa' = 'EFSA'")) %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte()
```

<br>
How often does your organization interact with the following agencies?
<br>
```{r,fig.width=6}
efsa_00 %>% 
  select(interact.eea:interact.efsa) %>%
  drop_na()%>% 
  gather() %>% 
  mutate(key = key %>% Recode("'interact.eea' = 'EEA';'interact.ema' = 'EMA';'interact.echa' = 'ECHA';'interact.efsa' = 'EFSA'")) %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  #scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  coord_flip()+
  theme_tufte()
```

<br>

##Outcome variables
<br>

###Perceived independece
<br>

The agency's opinions can be influenced by EU political institutions (European Commission, Council, Parliament).
```{r}
efsa_00 %>% 
  select(idependence.polit.efsa:idependence.polit.echa) %>% 
  gather() %>% 
  mutate(key = key %>% Recode("'idependence.polit.eea' = 'EEA';'idependence.polit.ema' = 'EMA';'idependence.polit.echa' = 'ECHA';'idependence.polit.efsa' = 'EFSA'")) %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte()
```

<br>
The agency's opinions can be influenced by the industry.
```{r}
efsa_00 %>% 
  select(idependence.industry.efsa:idependence.industry.echa) %>% 
  gather() %>% 
  mutate(key = key %>% Recode("'idependence.industry.eea' = 'EEA';'idependence.industry.ema' = 'EMA';'idependence.industry.echa' = 'ECHA';'idependence.industry.efsa' = 'EFSA'")) %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte()
```
<br>

```{r}
efsa_00 %>% 
  select(idependence.polit.efsa:idependence.polit.echa,
         idependence.industry.efsa:idependence.industry.echa) %>% 
  sjt.corr(triangle = "lower",show.p=T,p.numeric=T)
```
<br>
```{r, fig.width=8}
ggplot(efsa_00,aes(efsa_00$idependence.polit.efsa,
         efsa_00$idependence.industry.efsa,color=organization.type.raw))+
  geom_jitter(width = 0.05,height = 0.05,size=2,alpha=0.5)+
  geom_smooth(method="lm",colour="black",group=1)+
  scale_x_continuous(name="Independence from political stakeholders",breaks=-5:5)+
  scale_y_continuous(name="Independence from industry",breaks=-5:5)+
  theme_tufte()
```



<br>

###Credibility of decision
<br>

* I believe that the opinion was based strictly on scientific considerations. [credibility.pest.q1 | Q9.2]

* I believe that the opinion was influenced by political interests. [credibility.pest.q2 | Q9.3]

* I believe that the opinion was affected by the industry interests. [credibility.pest.q3 | Q9.4]

* I believe that the opinion was formed after evaluating all the relevant data and evidence. [credibility.pest.q4 | Q9.5]

* I believe that the assessment of the evidence was based on adequate methods. [credibility.pest.q5 | Q9.6]

* I believe that EFSA's opinion about the pesticide may change the next time it will be asked to reexamine it. [credibility.pest.q6 | Q9.7]


<br>
```{r, fig.width=6}
efsa_00 %>% 
  select(credibility.pest.q1:credibility.pest.q6) %>% 
  gather() %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte()
```
<br>

```{r}
efsa_00 %>% 
  select(credibility.pest.q1:credibility.pest.q6) %>% 
  sjt.corr(triangle = "lower",show.p=T,p.numeric=T)
```

<br>
```{r}
t1 <- efsa_00 %>% 
  select(credibility.pest.q1:credibility.pest.q6) %>% 
  mutate(credibility.pest.q2 = -1*credibility.pest.q2,
         credibility.pest.q3 = -1*credibility.pest.q3,
         credibility.pest.q6 = -1*credibility.pest.q6) 
t1 %>%
  select(credibility.pest.q1:credibility.pest.q6) %>% 
  sjt.itemanalysis()

```

```{r}
t1 <- t1 %>% 
  mutate(credibility.pest.index = (credibility.pest.q1+
           credibility.pest.q2+
           credibility.pest.q3+
           credibility.pest.q4+
           credibility.pest.q5+
           credibility.pest.q6)/6,
         credibility.pest.commitment = credibility.pest.q6,
         credibility.pest.considerations = (credibility.pest.q1+
           credibility.pest.q2+
           credibility.pest.q3)/3,
         credibility.pest.expertise = (credibility.pest.q4+
           credibility.pest.q5)/2)

efsa_00 <- efsa_00 %>% 
  mutate(credibility.pest.commitment = t1$credibility.pest.commitment,
         credibility.pest.considerations = t1$credibility.pest.considerations,
         credibility.pest.expertise = t1$credibility.pest.expertise,
         credibility.pest.index = t1$credibility.pest.index)

```
<br>
```{r,fig.width=6}
t1 <- efsa_00 %>% 
  select(credibility.pest.commitment:credibility.pest.expertise) %>% 
  gather() %>% 
  mutate(key = Recode(key,"'credibility.pest.commitment'='Credible commitment';'credibility.pest.considerations'='Relevant considerations';'credibility.pest.expertise'='Expertise & professional quality'"))

ggplot(t1,aes(x=key,y=value))+
  geom_boxplot()+
  geom_jitter(height = 0.1,width = 0 ,size=1,colour="dodgerblue2",alpha=0.6)+
  ggtitle("Credibility of decision")+
  scale_y_continuous(limits = c(-5,5),breaks=-5:5)+
  coord_flip()+
  theme_tufte()
```
<br>

###Credibility of EFSA
<br>
EFSA is a credible regulator.
<br>
```{r}
efsa_00 %>% 
  select(credibility.efsa.pre,
         credibility.efsa.post) %>% 
  gather() %>%
  mutate(key = key %>% Recode("'credibility.efsa.pre' = 'Pre-manipulation';'credibility.efsa.post' = 'Post-manipulation'")) %>%
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  theme_tufte()
```

<br>
```{r}
ggplot(efsa_00,aes(efsa_00$credibility.efsa.pre,
         efsa_00$credibility.efsa.post))+
  geom_jitter(width = 0.05,height = 0.05,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="Pre-manipulation",breaks=-5:5)+
  scale_y_continuous(name="Post-manipulation",breaks=-5:5)+
  theme_tufte()
```
<br>

```{r}
efsa_00 %>% 
  select(credibility.efsa.pre,
         credibility.efsa.post,
         credibility.pest.commitment:credibility.pest.expertise) %>% 
  sjt.corr(triangle = "lower",show.p=T,p.numeric=T)
```


<br>

###Reputation
<br>

**Reputation of EFSA:**  

*Technical*
<br>

* EFSA is a credible regulator [reputation.efsa.q1 | Q10.5]

* EFSA's employees are highly skilled in their profession. [reputation.efsa.q2 | Q10.6]

* EFSA's employees understand the problems and issues in the field. [reputation.efsa.q3 | Q10.7] 

* EFSA cooperates well with experts in the field. [reputation.efsa.q4 | Q10.8]

* EFSA sets new scientific standards. [reputation.efsa.q5 | Q10.9]
<br>

<br>
```{r, fig.width=6}
efsa_00 %>% 
  select(reputation.efsa.q1:reputation.efsa.q5) %>% 
  gather() %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(width = 0.75,fill="dodgerblue2",alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  ggtitle("Technical dimension")+
  facet_wrap(~key)+
  theme_tufte()
```
<br>
*Performative*
<br>

* EFSA’s output is of high quality. [reputation.efsa.q6 | Q10.10]

* EFSA is an effective organization. [reputation.efsa.q7 | Q10.11]

<br>
```{r}
efsa_00 %>% 
  select(reputation.efsa.q6:reputation.efsa.q7) %>% 
  gather() %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  ggtitle("Performative dimension")+
  facet_wrap(~key)+
  theme_tufte()
```
<br>
*Moral*
<br>

* EFSA’s mission is ethically defensible (their mission is the right mission). [reputation.efsa.q8 | Q10.12]

* EFSA has a positive influence on society. [reputation.efsa.q9 | Q10.13] 
<br>
```{r}
efsa_00 %>% 
  select(reputation.efsa.q8:reputation.efsa.q9) %>% 
  gather() %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  ggtitle("Moral dimension")+
  facet_wrap(~key)+
  theme_tufte()
```
<br>
*Procedural*
<br>

* Decision-making in EFSA follows due process. [reputation.efsa.q10 | Q10.14] 

* EFSA follows correct procedures. [reputation.efsa.q11 | Q10.15] 

* Please complete the following sentence: EFSA has a reputation for... [reputation.efsa.open | Q11.1]
<br>
```{r}
efsa_00 %>% 
  select(reputation.efsa.q10:reputation.efsa.q11) %>% 
  gather() %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  ggtitle("Procedural dimension")+
  facet_wrap(~key)+
  theme_tufte()
```
<br>

```{r}
efsa_00 %>% 
  select(reputation.efsa.q1:reputation.efsa.q11) %>% 
  sjt.corr(triangle = "lower",show.p=T,p.numeric=T)
```

<br>
```{r,fig.width=6}
efsa_00 <- efsa_00 %>% 
  mutate(reputation.efsa.technical = (reputation.efsa.q1+reputation.efsa.q2+reputation.efsa.q3+reputation.efsa.q4+reputation.efsa.q5)/5,
         reputation.efsa.performative = (reputation.efsa.q6+reputation.efsa.q7)/2,
         reputation.efsa.moral = (reputation.efsa.q8+reputation.efsa.q9)/2,
         reputation.efsa.procedural = (reputation.efsa.q10+reputation.efsa.q11)/2)

t1 <- efsa_00 %>% 
  select(reputation.efsa.technical:reputation.efsa.procedural) %>% 
  gather() %>% 
  mutate(key = Recode(key,"'reputation.efsa.technical'='Technical';'reputation.efsa.performative'='Performative';'reputation.efsa.moral'='Moral';'reputation.efsa.procedural'='Procedural'"))

ggplot(t1,aes(x=key,y=value))+
  geom_boxplot(width=0.5)+
  geom_jitter(height = 0.2,width = 0 ,size=1,colour="dodgerblue2",alpha=0.6)+
  ggtitle("Reputaional dimensions")+
  scale_y_continuous(limits = c(-5,5),breaks=-5:5)+
  coord_flip()+
  theme_tufte()

```
<br>

```{r}
efsa_00 %>% 
  filter(nchar(reputation.efsa.open)>1) %>% 
  select(reputation.efsa.open) %>% 
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F)
```
<br>

###All
<br>


```{r}
efsa_00 %>% 
  select(idependence.polit.efsa,
         idependence.industry.efsa,
   credibility.pest.commitment:credibility.pest.expertise,
   credibility.efsa.pre,
         credibility.efsa.post,
    reputation.efsa.technical:reputation.efsa.procedural) %>% 
  sjt.corr(triangle = "lower",show.p=T,p.numeric=T)
```



<br>

##Comments
<br>

```{r}
efsa_00 %>% 
  filter(nchar(open.text)>1) %>% 
  select(open.text) %>% 
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F)
```
<br>

<br>

#Randomization checks

<br>
```{r,fig.width=6}
t1 <- efsa_00 %>% 
  select(high.risk,
         treatment,
         female,
         age,
         trust.eu.commission,
         trust.eu.parliament,
         trust.eu.council,
         credibility.efsa.pre,
         credibility.efsa.pre,
         informed.efsa,
         affect.decisions.efsa,
         prior.beliefs.food) 


t1.1 = t1 %>%
  filter(high.risk==1) %>% 
  select(-high.risk) %>% 
  correlate() %>% 
  focus(treatment) %>%
  #mutate(rowname = reorder(rowname, treatment)) %>%
  mutate(high.risk.lab = "High risk")


t1.2 = t1 %>%
  filter(high.risk==0) %>%
  select(-high.risk) %>%
  correlate() %>% 
  focus(treatment) %>%
  #mutate(rowname = reorder(rowname, treatment)) %>%
  mutate(high.risk.lab = "Low risk")

t2 = rbind(t1.1,t1.2) %>% data.frame()



t2 %>%   
ggplot(aes(rowname, treatment,fill=high.risk.lab)) +
  geom_col(alpha=0.8,width = 0.75) +
  scale_y_continuous(name="correlation with treatment",
                     limits = c(-0.4,0.4))+
  coord_flip()+
  facet_wrap(~high.risk.lab)+
  theme_tufte()



```

<br>
```{r}
t1 %>% 
  correlate() %>% 
  focus(high.risk) %>%
  mutate(rowname = reorder(rowname, high.risk)) %>% 
  ggplot(aes(rowname, high.risk)) +
  geom_col(fill="dodgerblue2",alpha=0.8,width = 0.75) +
  scale_y_continuous(name="correlation with high risk",
                     limits = c(-0.5,0.5))+
  coord_flip()+
  theme_tufte()

```

<br>


```{r}
model.treatment.t1.1 <- glm(treatment~female+
         age+
         trust.eu.commission+
         trust.eu.parliament+
         trust.eu.council+
         credibility.efsa.pre+
         credibility.efsa.pre+
         informed.efsa+
         affect.decisions.efsa+
           prior.beliefs.food,
         data=filter(efsa_00,high.risk==0),
         family="binomial")

model.treatment.t1.2 <- glm(treatment~female+
         age+
         trust.eu.commission+
         trust.eu.parliament+
         trust.eu.council+
         credibility.efsa.pre+
         credibility.efsa.pre+
         informed.efsa+
         affect.decisions.efsa+
           prior.beliefs.food,
         data=filter(efsa_00,high.risk==1),
         family="binomial")

model.risk.t1 <- glm(high.risk~female+
         age+
         trust.eu.commission+
         trust.eu.parliament+
         trust.eu.council+
         credibility.efsa.pre+
         credibility.efsa.pre+
         informed.efsa+
         affect.decisions.efsa+
           prior.beliefs.food,
         data=efsa_00,
         family="binomial")



dwplot(list(Treatment.HighRisk=model.treatment.t1.1,
            Treatment.LowRisk=model.treatment.t1.2,
            Risk=model.risk.t1),
       vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2))+
  theme_tufte()

```
<br>

#Attrition differences

TBA

#Evaluation of manipulation 

##Cases

<br>
```{r}
sjp.frq(efsa_00$comprehension.check,
        ylim = c(0,nrow(efsa_00)),
        axis.labels = c("Incorrect","Correct"),
        title = "Comprehension of case")+ 
  theme_tufte()
```

<br>
```{r}
t1 <- efsa_00 %>% 
  select(comprehension.check,
         high.risk) %>% 
  mutate(high.risk = Recode(high.risk,"0='Low risk';1='High risk'"))

sjp.grpfrq(t1$comprehension.check,
           t1$high.risk,
           ylim = c(0,nrow(efsa_00)/2),
           axis.labels = c("Incorrect","Correct"),
        title = "Comprehension of case by pesticide",
        facet.grid = T,
        show.prc = F)+ 
  theme_tufte()
```

<br>

**View time**
```{r,fig.width=6}
efsa_00 %>% 
  select(viewtime.intro:viewtime.pesticide) %>%
  drop_na()%>% 
  gather() %>% 
  mutate(key = key %>% Recode("'viewtime.intro' = 'Introduction';'viewtime.manipulation' = 'Manipulation';'viewtime.pesticide' = 'pesticide case'")) %>% 
ggplot(aes(x=value,fill=key))+geom_histogram(fill="dodgerblue2",alpha=0.8)+
  scale_x_continuous(name="Time (in seconds))")+
  guides(fill=FALSE)+
  facet_wrap(~key)+
  #coord_flip()+
  theme_tufte()
```

<br>
**View time (manipulation by condition)**
```{r,fig.width=6}
efsa_00 %>%
  drop_na(treatment) %>% 
  mutate (treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>%
ggplot(aes(x=viewtime.manipulation,fill=treatment.lab))+geom_histogram(fill="dodgerblue2",alpha=0.8)+
  scale_x_continuous(name="Time (in seconds))")+
  guides(fill=FALSE)+
  facet_wrap(~treatment.lab)+
  #coord_flip()+
  theme_tufte()
```

<br>
```{r}
sjstats::grpmean(efsa_00,
                 viewtime.manipulation,
                 treatment,
                 out="v")
```
<br>

**View time (case by pesticide)**

<br>
```{r,fig.width=6}
efsa_00 %>%
  drop_na(high.risk) %>% 
  mutate (high.risk.lab = high.risk %>% Recode("0='Low risk';1='High risk'")) %>%
ggplot(aes(x=viewtime.pesticide,fill=treatment.lab))+geom_histogram(fill="dodgerblue2",alpha=0.8)+
  scale_x_continuous(name="Time (in seconds))")+
  guides(fill=FALSE)+
  facet_wrap(~high.risk.lab)+
  #coord_flip()+
  theme_tufte()
```

<br>
```{r}
sjstats::grpmean(efsa_00,
                 viewtime.pesticide,
                 high.risk,
                 out="v")
```
<br>


<br>
```{r}
sjp.frq(filter(efsa_00,viewtime.case.total>0)$viewtime.case.total,
        type="histogram",
        show.mean = T,
        title = "All")+
  theme_tufte()
```



<br>
**Familiarity with persicide case**
<br>
Were you familiar with EFSA's opinion about the pesticide ["Flupyradifurone"/"Amitrole"] prior to this survey?
<br>
```{r}
sjp.frq(efsa_00$familiarity.pesticide,
        ylim = c(0,nrow(efsa_00)*1.3),
        axis.labels = c("No","Yes"),
        title = "")+ 
  theme_tufte()
```

<br>
```{r}
t1 <- efsa_00 %>% 
  select(familiarity.pesticide,
         high.risk) %>% 
  mutate(high.risk = Recode(high.risk,"0='Low risk';1='High risk'"))

sjp.grpfrq(t1$familiarity.pesticide,
           t1$high.risk,
           axis.labels = c("No","Yes"),
        title = "",
        facet.grid = T,
        show.prc = F,
        legend.labels=c("a","b"))+ 
  theme_tufte()
```

<br>

##Independence
<br>
```{r}
efsa_00 %>% 
  drop_na(idependence.polit.efsa) %>% 
  mutate (treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>% 
ggplot(aes(idependence.polit.efsa,fill=factor(treatment.lab)))+ 
  geom_bar(width = 0.75,alpha=0.8)+
  scale_x_continuous(name="decisions influenced by political stakeholders",limits = c(-6,6),breaks = -5:5)+
  scale_fill_manual(values = c("dodgerblue2","orange2"))+
  guides(fill=FALSE)+
  facet_wrap(~treatment.lab)+
  theme_tufte()
```

<br>
```{r}
sjstats::grpmean(efsa_00,
                 idependence.polit.efsa,
                 treatment,
                 out="v")
```
<br>


```{r}
efsa_00 %>% 
  drop_na(idependence.polit.efsa) %>% 
  mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'"),
          high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>% 
ggplot(aes(x=treatment.lab,y=idependence.polit.efsa))+
  geom_boxplot()+
  geom_jitter(height = 0.1,width = 0.1 ,size=1,colour="dodgerblue2",alpha=0.6)+
    scale_y_continuous(limits = c(-5,5),breaks=-5:5)+
  xlab("")+
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", colour = "red",alpha=0.5,width=0.1,size=1) + 
  stat_summary(fun.y = mean, geom = "point", colour = "red",size=2)+
  stat_summary(fun.y = mean, geom = "line", colour = "red",alpha=0.5,size=1, aes(group = 1))+
  
  #ggtitle("Credibility of decision")+
  #coord_flip()+
  facet_wrap(~high.risk.lab)+
  theme_tufte()
```
<br>

```{r}
sjstats::grpmean(filter(efsa_00,high.risk==1),
                 idependence.polit.efsa,
                 treatment,
                 out="v")
```


<br>
```{r}
efsa_00 %>% 
  drop_na(idependence.industry.efsa) %>% 
  mutate (treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>% 
ggplot(aes(idependence.industry.efsa,fill=factor(treatment.lab)))+ 
  geom_bar(width = 0.75,alpha=0.8)+
  scale_x_continuous(name="decisions influenced by industry",limits = c(-6,6),breaks = -5:5)+
  scale_fill_manual(values = c("dodgerblue2","orange2"))+
  guides(fill=FALSE)+
  facet_wrap(~treatment.lab)+
  theme_tufte()
```

<br>
```{r}
sjstats::grpmean(efsa_00,
                 idependence.industry.efsa,
                 treatment,
                 out="v")
```

<br>


```{r}
efsa_00 %>% 
  drop_na(idependence.industry.efsa) %>% 
  mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'"),
          high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>% 
ggplot(aes(x=treatment.lab,y=idependence.industry.efsa))+
  geom_boxplot()+
  geom_jitter(height = 0.1,width = 0.1 ,size=1,colour="dodgerblue2",alpha=0.6)+
    scale_y_continuous(limits = c(-5,5),breaks=-5:5)+
  xlab("")+
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", colour = "red",alpha=0.5,width=0.1,size=1) + 
  stat_summary(fun.y = mean, geom = "point", colour = "red",size=2)+
  stat_summary(fun.y = mean, geom = "line", colour = "red",alpha=0.5,size=1, aes(group = 1))+
  
  #ggtitle("Credibility of decision")+
  #coord_flip()+
  facet_wrap(~high.risk.lab)+
  theme_tufte()
```
<br>
```{r}
efsa_00 %>% 
  drop_na(idependence.polit.efsa) %>% 
  mutate (high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>% 
ggplot(aes(idependence.polit.efsa,fill=factor(high.risk.lab)))+ 
  geom_bar(width = 0.75,alpha=0.8)+
  scale_x_continuous(name="Independence from politicians",limits = c(-6,6),breaks = -5:5)+
  scale_fill_manual(values = c("dodgerblue2","orange2"))+
  guides(fill=FALSE)+
  facet_wrap(~high.risk.lab)+
  theme_tufte()
```

<br>

```{r}
efsa_00 %>% 
  drop_na(idependence.industry.efsa) %>% 
  mutate (high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>% 
ggplot(aes(idependence.industry.efsa,fill=factor(high.risk.lab)))+ 
  geom_bar(width = 0.75,alpha=0.8)+
  scale_x_continuous(name="Independence from industry",limits = c(-6,6),breaks = -5:5)+
  scale_fill_manual(values = c("dodgerblue2","orange2"))+
  guides(fill=FALSE)+
  facet_wrap(~high.risk.lab)+
  theme_tufte()
```
<br>

#Outcome variables

##Model for credibility
<br>

```{r}
efsa_00 %>% 
  drop_na(high.risk) %>% 
  mutate(high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>% 
ggplot(aes(x=high.risk.lab,y=credibility.pest.index))+
  geom_boxplot()+
  geom_jitter(height = 0.1,width = 0 ,size=1,colour="dodgerblue2",alpha=0.6)+
    scale_y_continuous(name = "Decision creibility",breaks=-5:5)+
  ggtitle("Credibility of decision")+
  coord_flip()+
  theme_tufte()
```

<br>
```{r,fig.width=6}
t1 <- efsa_00 %>% 
  select(high.risk,
         treatment,
         high.risk,
         female,
         age,
         trust.eu.commission,
         trust.eu.parliament,
         trust.eu.council,
         credibility.efsa.pre,
         informed.efsa,
         affect.decisions.efsa,
         prior.beliefs.food) 

t1.1 = t1 %>%
  filter(high.risk==1) %>% 
  select(-high.risk) %>% 
  correlate() %>% 
  focus(treatment) %>%
  mutate(rowname = reorder(rowname, treatment)) %>%
  mutate(high.risk.lab = "High risk")


t1.2 = t1 %>%
  filter(high.risk==0) %>%
  select(-high.risk) %>%
  correlate() %>% 
  focus(treatment) %>%
  mutate(rowname = reorder(rowname, treatment)) %>%
  mutate(high.risk.lab = "Low risk")

t2 = rbind(t1.1,t1.2) %>% data.frame()

t2 %>%   
ggplot(aes(rowname, treatment,fill=high.risk.lab)) +
  geom_col(alpha=0.8,width = 0.75) +
  scale_y_continuous(name="correlation with treatment",
                     limits = c(-0.5,0.5))+
  coord_flip()+
  facet_wrap(~high.risk.lab)+
  theme_tufte()



```



<br>
```{r}
model.pest.credibility.t1 <- lm(credibility.pest.index~ high.risk+
         female+
         age+
         trust.eu.commission+
         trust.eu.parliament+
         trust.eu.council+
         credibility.efsa.pre+
         informed.efsa+
         affect.decisions.efsa+
         prior.beliefs.food,
         data=efsa_00)

model.pest.credibility.t2 <- lm(credibility.pest.index~ high.risk+
         credibility.efsa.pre+
           trust.eu.parliament+
         informed.efsa+
           prior.beliefs.food,
         data=efsa_00)

dwplot(list(model.pest.credibility.t1,model.pest.credibility.t2),
       vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2))+
  scale_color_manual(name="Agency type",values = viridis(3))+
  theme_tufte()
```

<br>
```{r,fig.width=6}
efsa_00 %>% 
  drop_na(high.risk) %>% 
  mutate(high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>%
ggplot(aes(credibility.efsa.pre,
           credibility.pest.index))+
  geom_jitter(width = 0.05,height = 0.05,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="Credibility of EFSA (pre manipulation)",breaks=-5:5)+
  scale_y_continuous(name = "Decision creibility",breaks=-5:5)+
  ggtitle("")+
  facet_wrap(~high.risk.lab)+
  theme_tufte()
```
<br>
```{r,fig.width=6}
efsa_00 %>% 
  drop_na(high.risk) %>% 
  mutate(high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>%
ggplot(aes(supports.pesticides,
           credibility.pest.index))+
  geom_jitter(width = 0.05,height = 0.05,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="supports.pesticides",breaks=-5:5)+
  scale_y_continuous(name = "Decision creibility",breaks=-5:5)+
  ggtitle("")+
  facet_wrap(~high.risk.lab)+
  theme_tufte()
```
<br>
```{r,fig.width=6}
efsa_00 %>% 
  drop_na(high.risk) %>% 
  mutate(high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>%
ggplot(aes(idependence.polit.efsa,
           credibility.pest.index))+
  geom_jitter(width = 0.05,height = 0.05,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="Perceived independence (5=high)",breaks=-5:5)+
  scale_y_continuous(name = "Decision creibility",breaks=-5:5)+
  ggtitle("")+
  facet_wrap(~high.risk.lab)+
  theme_tufte()
```
<br>



##Effect of treatment on credibility
<br>
```{r,fig.width=6}
t1 <- efsa_00 %>% 
  select(high.risk,
         idependence.polit.efsa,
         treatment,
         credibility.pest.commitment:credibility.pest.expertise,
         credibility.efsa.pre,
         credibility.efsa.post,
         reputation.efsa.technical:reputation.efsa.procedural) 

t1.1 = t1 %>%
  filter(high.risk==1) %>% 
  select(-high.risk) %>% 
  correlate() %>% 
  focus(treatment) %>%
  #mutate(rowname = reorder(rowname, treatment)) %>%
  mutate(high.risk.lab = "High risk")


t1.2 = t1 %>%
  filter(high.risk==0) %>%
  select(-high.risk) %>%
  correlate() %>% 
  focus(treatment) %>%
  #mutate(rowname = reorder(rowname, treatment)) %>%
  mutate(high.risk.lab = "Low risk")

t2 = rbind(t1.1,t1.2) %>% data.frame()

t2 %>%   
ggplot(aes(rowname, treatment,fill=high.risk.lab)) +
  geom_col(alpha=0.8,width = 0.75) +
  scale_y_continuous(name="correlation with treatment")+
  coord_flip()+
  facet_wrap(~high.risk.lab)+
  theme_tufte()

```
<br>
```{r,fig.width=6}
t1 <- efsa_00 %>% 
  select(high.risk,
         idependence.polit.efsa,
         treatment,
         credibility.pest.commitment:credibility.pest.expertise,
         credibility.efsa.pre,
         credibility.efsa.post,
         reputation.efsa.technical:reputation.efsa.procedural) 


t1 %>%
  correlate() %>% 
  focus(high.risk) %>%
ggplot(aes(rowname, high.risk)) +
  geom_col(alpha=0.8,width = 0.75,fill="dodgerblue2",alpha=0.7) +
  scale_y_continuous(name="correlation with High risk case")+
  coord_flip()+
  theme_tufte()
```




<br>
```{r}
efsa_00 %>% 
  drop_na(credibility.pest.index) %>% 
  mutate (treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>% 
ggplot(aes(x=treatment.lab,y=credibility.pest.index))+
  geom_boxplot()+
  geom_jitter(height = 0.1,width = 0 ,size=1,colour="dodgerblue2",alpha=0.6)+
    scale_y_continuous(name = "Decision creibility",limits = c(-5,5),breaks=-5:5)+
  #ggtitle("Credibility of decision")+
  #coord_flip()+
  theme_tufte()
```
<br>

```{r}
efsa_00 %>% 
  drop_na(credibility.pest.index) %>% 
  mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'"),
          high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>% 
ggplot(aes(x=treatment.lab,y=credibility.pest.index))+
  geom_boxplot()+
  geom_jitter(height = 0.1,width = 0.1 ,size=1,colour="dodgerblue2",alpha=0.6)+
    scale_y_continuous(limits = c(-5,5),breaks=-5:5)+
  
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", colour = "red",alpha=0.5,width=0.1,size=1) + 
  stat_summary(fun.y = mean, geom = "point", colour = "red",size=2)+
  stat_summary(fun.y = mean, geom = "line", colour = "red",alpha=0.5,size=1, aes(group = 1))+
  
  #ggtitle("Credibility of decision")+
  #coord_flip()+
  facet_wrap(~high.risk.lab)+
  theme_tufte()
```
<br>


<br>

**Low risk**
```{r}
sjstats::grpmean(filter(efsa_00,high.risk==0),
                 credibility.pest.index,
                 treatment,
                 out="v")
```

<br>

**High risk**
```{r}
sjstats::grpmean(filter(efsa_00,high.risk==1),
                 credibility.pest.index,
                 treatment,
                 out="v")
```

<br>

```{r}
efsa_00 %>% 
  drop_na(credibility.efsa.post) %>% 
  mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'"),
          high.risk.lab = high.risk %>% Recode("0='Low risk'; 1='High risk'")) %>% 
ggplot(aes(x=treatment.lab,y=credibility.efsa.post))+
  geom_boxplot()+
  geom_jitter(height = 0.1,width = 0.1 ,size=1,colour="dodgerblue2",alpha=0.6)+
    scale_y_continuous(limits = c(-5,5),breaks=-5:5)+
  xlab("")+
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", colour = "red",alpha=0.5,width=0.1,size=1) + 
  stat_summary(fun.y = mean, geom = "point", colour = "red",size=2)+
  stat_summary(fun.y = mean, geom = "line", colour = "red",alpha=0.5,size=1, aes(group = 1))+
  
  #ggtitle("Credibility of decision")+
  #coord_flip()+
  facet_wrap(~high.risk.lab)+
  theme_tufte()
```


<br>

#Other agencies

##From politicians
<br>

```{r,fig.width=6}
efsa_00 %>% 
select(treatment,
       idependence.polit.efsa,
       idependence.industry.efsa,
       credibility.efsa.pre) %>% 
 mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>% 
  select(-treatment) %>%  
gather("independence.of","value",-treatment.lab,-credibility.efsa.pre) %>%
  mutate(independence.of = independence.of %>% Recode("'idependence.polit.efsa'='Idependence of politicians';'idependence.industry.efsa'='Idependence of industry'")) %>% 
  ggplot(aes(value,
           credibility.efsa.pre))+
  geom_jitter(width = 0.1,height = 0.1,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="5=high",breaks=-5:5)+
  scale_y_continuous(name = "Perceived creibility of agency (pre manipulation)",breaks=-5:5)+
  ggtitle("EFSA")+
  facet_wrap(~independence.of)+
  theme_tufte()  
  

```

<br>

```{r,fig.width=6}
efsa_00 %>% 
select(treatment,
       idependence.polit.efsa,
       idependence.industry.efsa,
       credibility.efsa.post) %>% 
 mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>% 
  select(-treatment) %>%  
gather("independence.of","value",-treatment.lab,-credibility.efsa.post) %>%
  mutate(independence.of = independence.of %>% Recode("'idependence.polit.efsa'='Idependence of politicians';'idependence.industry.efsa'='Idependence of industry'")) %>% 
  ggplot(aes(value,
           credibility.efsa.post))+
  geom_jitter(width = 0.1,height = 0.1,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="5=high",breaks=-5:5)+
  scale_y_continuous(name = "Perceived creibility of agency (post manipulation)",breaks=-5:5)+
  ggtitle("EFSA")+
  facet_wrap(~independence.of)+
  theme_tufte()  
  

```
<br>

```{r,fig.width=6}
efsa_00 %>%
  drop_na(treatment) %>% 
  mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>%
ggplot(aes(idependence.polit.efsa,
           credibility.efsa.post))+
  geom_jitter(width = 0.05,height = 0.05,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="Perceived independence from politicians (5=high)",breaks=-5:5)+
  scale_y_continuous(name = "Perceived creibility (post manipulation)",breaks=-5:5)+
  ggtitle("EFSA")+
  facet_wrap(~treatment.lab)+
  theme_tufte()
```
<br>
```{r}
efsa_00 %>%
  drop_na(treatment) %>% 
  mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>%
ggplot(aes(idependence.industry.efsa,
           credibility.efsa.post))+
  geom_jitter(width = 0.1,height = 0.1,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="Perceived independence from industry (5=high)",breaks=-5:5)+
  scale_y_continuous(name = "Perceived creibility (post manipulation)",breaks=-5:5)+
  ggtitle("EFSA")+
  facet_wrap(~treatment.lab)+
  theme_tufte()
```


<br>

```{r,fig.width=6}
efsa_00 %>% 
select(treatment,
       idependence.polit.eea,
       idependence.industry.eea,
       credibility.eea.pre) %>% 
 mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>% 
  select(-treatment) %>%  
gather("independence.of","value",-treatment.lab,-credibility.eea.pre) %>%
  mutate(independence.of = independence.of %>% Recode("'idependence.polit.eea'='Idependence of politicians';'idependence.industry.eea'='Idependence of industry'")) %>% 
  ggplot(aes(value,
           credibility.eea.pre))+
  geom_jitter(width = 0.1,height = 0.1,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="5=high",breaks=-5:5)+
  scale_y_continuous(name = "Perceived creibility of agency (pre manipulation)",breaks=-5:5)+
  ggtitle("EEA")+
  facet_wrap(~independence.of)+
  theme_tufte()  
  

```
<br>
```{r}
efsa_00 %>% 
select(treatment,
       idependence.polit.ema,
       idependence.industry.ema,
       credibility.ema.pre) %>% 
 mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>% 
  select(-treatment) %>%  
gather("independence.of","value",-treatment.lab,-credibility.ema.pre) %>%
  mutate(independence.of = independence.of %>% Recode("'idependence.polit.ema'='Idependence of politicians';'idependence.industry.ema'='Idependence of industry'")) %>% 
  ggplot(aes(value,
           credibility.ema.pre))+
  geom_jitter(width = 0.1,height = 0.1,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="5=high",breaks=-5:5)+
  scale_y_continuous(name = "Perceived creibility of agency (pre manipulation)",breaks=-5:5)+
  ggtitle("EMA")+
  facet_wrap(~independence.of)+
  theme_tufte()  
  

```
<br>
```{r}
efsa_00 %>% 
select(treatment,
       idependence.polit.echa,
       idependence.industry.echa,
       credibility.echa.pre) %>% 
 mutate(treatment.lab = treatment %>% Recode("0='Control';1='Treatment'")) %>% 
  select(-treatment) %>%  
gather("independence.of","value",-treatment.lab,-credibility.echa.pre) %>%
  mutate(independence.of = independence.of %>% Recode("'idependence.polit.echa'='Idependence of politicians';'idependence.industry.echa'='Idependence of industry'")) %>% 
  ggplot(aes(value,
           credibility.echa.pre))+
  geom_jitter(width = 0.1,height = 0.1,size=2,colour="dodgerblue2",alpha=0.5)+
  geom_smooth(method="lm",colour="black")+
  scale_x_continuous(name="5=high",breaks=-5:5)+
  scale_y_continuous(name = "Perceived creibility of agency (pre manipulation)",breaks=-5:5)+
  ggtitle("ECHA")+
  facet_wrap(~independence.of)+
  theme_tufte()  
```
<br>

#Moderation of prior beliefs
<br>
TBA


<br>

#END

