---
title: "EFSA_experiment"
author: "Saar Alon-Barkat"
date: "2019"
output:
  html_document:
    code_folding: hide
    fig_captions: yes
    highlight: haddock
    number_sections: yes
    theme: flatly
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
      toc_depth: 3
---



Last update: `r Sys.time()`


```{r set-global-options, echo = FALSE}
knitr::opts_chunk$set(eval = TRUE, 
                      echo = TRUE, 
                      message=FALSE,
                      warning = FALSE,
                      cache = FALSE,
                      include = TRUE,
                      collapse = FALSE,
                      dependson = NULL,
                      engine = "R", #  Chunks will always have R code, unless noted
                      error = TRUE,
                      fig.path="Figures/",  #  Set the figure options
                      fig.align = "left",
                      fig.width = 6,
                      fig.height = 4)
```


```{r silent-packages, echo = FALSE, eval = TRUE, message=FALSE, include = FALSE}
library(sjPlot)
library(tidyverse)
library(car)
library(reshape2)
library(viridis)
library(ggthemes)
library(corrr)
library(kableExtra)
library(dotwhisker)
library(sjmisc)
library(interflex)
library(effsize)
library(broom)
library(sjstats)
library(stargazer)
library(AER)
```


```{r}
#import data
source("efsa_dm_01.R")

efsa_00.t1 <- efsa_00 %>% 
  drop_na(independence.polit.efsa) %>% 
  data.frame() %>% 
  mutate(approve.pesticide = ban.pesticide %>% Recode("0=1;1=0"))

```
<br>

# Reputation items: 

<br>

**Technical**

<br>

* EFSA is a credible regulator [reputation.efsa.q1 | Q10.5]

* EFSA's employees are highly skilled in their profession. [reputation.efsa.q2 | Q10.6]

* EFSA's employees understand the problems and issues in the field. [reputation.efsa.q3 | Q10.7] 

* EFSA cooperates well with experts in the field. [reputation.efsa.q4 | Q10.8]

* EFSA sets new scientific standards. [reputation.efsa.q5 | Q10.9]
<br>

<br>

```{r, fig.width=6}
efsa_00 %>% 
  select(reputation.efsa.q1:reputation.efsa.q5) %>% 
  gather() %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(width = 0.75,fill="dodgerblue2",alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  ggtitle("Technical dimension")+
  facet_wrap(~key)+
  theme_tufte()
```

```{r}
efsa_00 %>% 
  select(reputation.efsa.q1:reputation.efsa.q5) %>% 
sjt.itemanalysis()
```

<br>

**Performative**
<br>

* EFSA’s output is of high quality. [reputation.efsa.q6 | Q10.10]

* EFSA is an effective organization. [reputation.efsa.q7 | Q10.11]

<br>
```{r}
efsa_00 %>% 
  select(reputation.efsa.q6:reputation.efsa.q7) %>% 
  gather() %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  ggtitle("Performative dimension")+
  facet_wrap(~key)+
  theme_tufte()
```


```{r}
efsa_00 %>% 
  select(reputation.efsa.q6:reputation.efsa.q7) %>% 
sjt.itemanalysis()
```

<br>


**Moral**
<br>

* EFSA’s mission is ethically defensible (their mission is the right mission). [reputation.efsa.q8 | Q10.12]

* EFSA has a positive influence on society. [reputation.efsa.q9 | Q10.13] 
<br>
```{r}
efsa_00 %>% 
  select(reputation.efsa.q8:reputation.efsa.q9) %>% 
  gather() %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  ggtitle("Moral dimension")+
  facet_wrap(~key)+
  theme_tufte()
```


```{r}
efsa_00 %>% 
  select(reputation.efsa.q8:reputation.efsa.q9) %>% 
sjt.itemanalysis()
```

<br>


**Procedural**
<br>

* Decision-making in EFSA follows due process. [reputation.efsa.q10 | Q10.14] 

* EFSA follows correct procedures. [reputation.efsa.q11 | Q10.15] 

* Please complete the following sentence: EFSA has a reputation for... [reputation.efsa.open | Q11.1]

<br>
```{r}
efsa_00 %>% 
  select(reputation.efsa.q10:reputation.efsa.q11) %>% 
  gather() %>% 
ggplot(aes(x=value,fill=key))+
  geom_bar(fill="dodgerblue2",width = 0.75,alpha=0.8)+
  scale_x_continuous(limits = c(-6,6),breaks = -5:5)+
  guides(fill=FALSE)+
  ggtitle("Procedural dimension")+
  facet_wrap(~key)+
  theme_tufte()
```

```{r}
efsa_00 %>% 
  select(reputation.efsa.q10:reputation.efsa.q11) %>%
sjt.itemanalysis()
```

<br>

```{r}
efsa_00 %>% 
  select(reputation.efsa.q1:reputation.efsa.q11) %>% 
  sjt.corr(triangle = "lower",show.p=T,p.numeric=T)
```

<br>


```{r,fig.width=6}
efsa_00 <- efsa_00 %>% 
  mutate(reputation.efsa.technical = (reputation.efsa.q1+reputation.efsa.q2+reputation.efsa.q3+reputation.efsa.q4+reputation.efsa.q5)/5,
         reputation.efsa.performative = (reputation.efsa.q6+reputation.efsa.q7)/2,
         reputation.efsa.moral = (reputation.efsa.q8+reputation.efsa.q9)/2,
         reputation.efsa.procedural = (reputation.efsa.q10+reputation.efsa.q11)/2)

t1 <- efsa_00 %>% 
  select(reputation.efsa.technical:reputation.efsa.procedural) %>% 
  gather() %>% 
  mutate(key = Recode(key,"'reputation.efsa.technical'='Technical';'reputation.efsa.performative'='Performative';'reputation.efsa.moral'='Moral';'reputation.efsa.procedural'='Procedural'"))

ggplot(t1,aes(x=key,y=value))+
  geom_boxplot(width=0.5)+
    stat_summary(fun.data = mean_cl_normal, geom = "errorbar", colour = "red",alpha=0.5,width=0.1,size=1) + 
  stat_summary(fun.y = mean, geom = "point", colour = "red",alpha=0.5,size=2)+
  ggtitle("Reputaional dimensions")+
  scale_y_continuous(limits = c(-5,5),breaks=-5:5)+
  coord_flip()+
  theme_tufte()

```

<br>

# Reputation by audience

<br>

NGOs tend to view EFSA more negatively. They report lower scores (then industry and others) on all four dimensions. 

<br>


```{r}
efsa_00 %>% 
  drop_na(ban.pesticide) %>% 
  select(reputation.efsa.technical:reputation.efsa.procedural,
         organization.type.short) %>% 
  gather("key","value",-organization.type.short) %>% 
  mutate(key = Recode(key,"'reputation.efsa.technical'='Technical';'reputation.efsa.performative'='Performative';'reputation.efsa.moral'='Moral';'reputation.efsa.procedural'='Procedural'")) %>% 
ggplot(aes(x=key,y=value,color=organization.type.short,shape=organization.type.short))+
  geom_boxplot(width = 0.5)+
      stat_summary(fun.data = mean_cl_normal, fun.args=list(conf.int=0.95), geom = "errorbar", colour = "red",alpha=0.5,width=0.1,size=1,position=position_dodge(0.5)) + 
  stat_summary(fun.y = mean, geom = "point", colour = "red",alpha=0.5,size=2,position=position_dodge(0.5))+
  scale_y_continuous(limits = c(-5,5),breaks=-5:5)+
  scale_shape_manual(guide=F,values=c(1,1,1))+
  scale_color_manual(name = "Organization type", values=c("gray60","dodgerblue2","green4"))+
  xlab("")+
  ylab("")+
  # facet_wrap(~ban.pesticide.lab)+
  coord_flip()+
  theme_tufte()+
  labs(title = "Reputaional dimensions",
              subtitle = "",
              caption = "Note: Red dots and bars represent means and 95% CIs")+
  theme(
  plot.caption = element_text(hjust = 0),
        legend.position="top"
  )
```

<br>

**Industry**
```{r}
efsa_00 %>% 
  filter(organization.type.short=="1-industry",
         nchar(reputation.efsa.open)>1) %>% 
  select(reputation.efsa.open) %>% 
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F) %>% 
  scroll_box(height = "400px")
```


<br>

**NGOs**
```{r}
efsa_00 %>% 
  filter(organization.type.short=="2-ngo",
         nchar(reputation.efsa.open)>1) %>% 
  select(reputation.efsa.open) %>% 
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F) %>% 
  scroll_box(height = "400px")
```


<br>
**Others**
```{r}
efsa_00 %>% 
  filter(organization.type.short=="0-other",
         nchar(reputation.efsa.open)>1) %>% 
  select(reputation.efsa.open) %>% 
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F) %>% 
  scroll_box(height = "400px")
```

<br>


# Reputation across different regulatory outputs

<br>

We take advantage of the random assignment to different pesticides opinions were they were shown before the reputation items. They were assigned to a real opinion of EFSA that either approves a pesticide, or bans a pesticide.

We compare the reputational dimensions between the two opinions, across the different organizational groups. For participants from industry and others, there were no differences between the two opinions. For the NGOs, those who read the ban opinion reported higher scores on all dimensions, but the differences are significant only for the *moral* dimension (bottom right). In other words, NGO members who saw an opinion by EFSA of banning a pesticide were not only more likely to report that the decision is credible, but also to state that "EFSA’s mission is ethically defensible (their mission is the right mission)" and that "EFSA has a positive influence on society". Effect size is 0.88 [0.22 -- 1.53] SDs (regression model with controls). 

This is evidence that NGO members' perceptions about the moral reputation of EFSA is shaped by their claims of under-regulation. 


<br>

```{r, echo=FALSE, warning=FALSE, message=F, fig.width=8}
efsa_00 %>%
  drop_na(ban.pesticide) %>%
  select(reputation.efsa.technical:reputation.efsa.procedural,
         ban.pesticide.lab, organization.type.short) %>%
  gather("key", "value", -ban.pesticide.lab, -organization.type.short) %>%
  mutate(key = Recode(key,"'reputation.efsa.technical'='Technical';'reputation.efsa.performative'='Performative';'reputation.efsa.moral'='Moral';'reputation.efsa.procedural'='Procedural'")) %>% 
  ggplot(aes(
    x = key,
    y = value,
    color = ban.pesticide.lab,
    shape = ban.pesticide.lab
  )) +
  geom_boxplot(width = 0.5) +
  stat_summary(
    fun.data = mean_cl_normal,
    geom = "errorbar",
    fun.args = list(conf.int = 0.95),
    colour = "red",
    alpha = 0.5,
    width = 0.1,
    size = 1,
    position = position_dodge(0.5)
  ) +
  stat_summary(
    fun.y = mean,
    geom = "point",
    colour = "red",
    alpha = 0.5,
    size = 2,
    position = position_dodge(0.5)
  ) +
  scale_y_continuous(limits = c(-5, 5), breaks = -5:5) +

  
  scale_shape_manual(
    name = "Regulatory outcome",
    values = c(1, 1),
    labels = c("Approve pesticide (Flup.)", "Ban pesticide (amitrole)")
  ) +
  scale_color_manual(
    name = "Regulatory outcome",
    values = c("gray10", "gray50"),
    labels = c("Approve pesticide (Flup.)", "Ban pesticide (amitrole)")
  ) +
  ylab("") +
  coord_flip()+
  theme_tufte() +
  facet_wrap(~organization.type.short)+
  labs(title = "",
       subtitle = "",
       caption = "Note: Red dots and bars represent means and 95% CIs") +
  theme(plot.caption = element_text(hjust = 0),
        legend.position="top")
```

<br>

```{r}

efsa_00.ngo <- efsa_00 %>% filter(organization.type.short == "2-ngo")

tmod.reputation.technical.ngos.1 <- 
lm(reputation.efsa.technical ~
                                 ban.pesticide,
                               data = efsa_00.ngo,na.action = "na.omit")

tmod.reputation.technical.ngos.2 <- update(
  tmod.reputation.technical.ngos.1,
  . ~ . +
    independence.polit.efsa +
    trust.eu.commission +
    trust.eu.parliament +
    trust.eu.council +
    affect.decisions.efsa +
    informed.efsa
)

tmod.reputation.performative.ngos.1 <- update(tmod.reputation.technical.ngos.1, reputation.efsa.performative ~ .)
tmod.reputation.performative.ngos.2 <- update(tmod.reputation.technical.ngos.2, reputation.efsa.performative ~ .)

tmod.reputation.moral.ngos.1 <- update(tmod.reputation.technical.ngos.1, reputation.efsa.moral ~ .)
tmod.reputation.moral.ngos.2 <- update(tmod.reputation.technical.ngos.2, reputation.efsa.moral ~ .)

tmod.reputation.procedural.ngos.1 <- update(tmod.reputation.technical.ngos.1, reputation.efsa.procedural ~ .)
tmod.reputation.procedural.ngos.2 <- update(tmod.reputation.technical.ngos.2, reputation.efsa.procedural ~ .)

tab_model(tmod.reputation.technical.ngos.1,tmod.reputation.technical.ngos.2,
          tmod.reputation.performative.ngos.1,tmod.reputation.performative.ngos.2,
          tmod.reputation.procedural.ngos.1,tmod.reputation.procedural.ngos.2,
          tmod.reputation.moral.ngos.1,tmod.reputation.moral.ngos.2)
```

<br>

```{r}
efsa_00 %>% 
  drop_na(credibility.pest.commitment) %>% 
ggplot(aes(x=organization.type.short,y=reputation.efsa.moral,
           shape=ban.pesticide.lab,
           color=ban.pesticide.lab))+
  geom_boxplot(width = 0.5)+
    scale_y_continuous(name="Moral reputation",limits = c(-5,5),breaks=-5:5)+
  xlab("")+
  stat_summary(fun.data = mean_cl_normal, geom = "errorbar", colour = "red",alpha=0.5,width=0.1,size=1,position=position_dodge(0.5)) + 
  stat_summary(fun.y = mean, geom = "point", colour = "red",size=2,position=position_dodge(0.5))+
    scale_shape_manual(guide=F,values=c(19,1))+
  scale_color_manual(
    name = "Regulatory outcome",
    values = c("gray10", "gray50"),
    labels = c("Approve pesticide (Flup.)", "Ban pesticide (amitrole)")
  ) +
# facet_wrap(~ban.pesticide.lab)+
  theme_tufte()
```


# Moral reputation and prior beliefs

<br>

I regressed the moral dimension on the items on participants' prior beliefs. It is positively correlated with support for pesticides but negatively correlated with support for GMOs (this is perhaps because they do not beileve that EFSA udner-regulate GMOs...). It is also positively correlated with perceived independence from industry. 



```{r}
#tmod.reputation.moral.11 <- 
lm(reputation.efsa.moral ~
     #organization.type.short+       
     #ban.pesticide+
     independence.polit.efsa+
     independence.industry.efsa+
     supports.pesticides+
     supports.additives+
     supports.gmo,
                               data = efsa_00,na.action = "na.omit") %>% plot_model(type="std")


```





# END

